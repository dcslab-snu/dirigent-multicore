#include "global.h"
#include "monitor.h"
#include "process.h"

static int SAMPLE_LEN;
//static int MAX_SAMPLE_LEN = 200/0.05; // 4000 samples
static uint64* scycle;
static uint64* sinstr;
static uint EXCERPT_LEN;
static const int EXCERPT_NUM = 350;
static const int MAX_SAMPLE_NUM = 200/0.05; // 4000 samples
static const int FREQ_ARR[] = {
  1200000,1300000,1400000,1500000,1600000,1700000,1800000,1900000,2000000,2100000};
//static int next_bg = 1;

int64* excerpt_penalty[CORE_NUM];

monitor_c::monitor_c(process_c** ps, int pn, int fn, string fg_name, process_manager_c* proc_mngr)
{
  mngr = proc_mngr;
  process = ps;
  process_num = pn;
  fg_num = fn;
  m_sample_num = 0;
  for (int i=0; i<CORE_NUM; i++) {
    sample_num[i] = 1;
    fg_freq_idx[i] = MAX_FREQ_IDX;
  }

  bg_freq_idx = MAX_FREQ_IDX;
  scycle = new uint64[MAX_SAMPLE_NUM];
  sinstr = new uint64[MAX_SAMPLE_NUM];

  // FIXME: Need debugging (code added by ysnam)
  string filename_cycle = fg_name + "_cycle.csv";
  string filename_instr = fg_name + "_instr.csv";
  string base_path = "../offline_solorun_data/simmedium/";
  //string base_path = "../offline_solorun_data/native/";
  string cyc_path = base_path + filename_cycle;
  string ins_path = base_path + filename_instr;

  const char *cycle_cstr_file = cyc_path.c_str();
  const char *instr_cstr_file = ins_path.c_str();
  int cyc_samples = 0;
  int instr_samples = 0;
  string scycle_line, sinstr_line;
  memset(scycle, 0, sizeof(scycle));
  memset(sinstr, 0, sizeof(sinstr));

#ifndef PRINT_SAMPLES
  // reading samples of cycles from ${fg_name}_cycle.data
  ifstream ifile_cyc(cycle_cstr_file, ifstream::in);
  if (!ifile_cyc.is_open()) {
    errExit("failed to open file: cycle.csv");
  }

  cyc_samples = 0;
  while (ifile_cyc.peek() != '\n') {
    getline(ifile_cyc, scycle_line, ',');
    sscanf(scycle_line.c_str(), "%llu", &scycle[cyc_samples]);
    cyc_samples++;
  }
  cout << "cyc_samples: " << cyc_samples << endl;
  ifile_cyc.close();

  // reading samples of instr. rates from ${fg_name}_instr.data
  ifstream ifile_ins(instr_cstr_file, ifstream::in);
  if (!ifile_ins.is_open()) {
    errExit("failed to open file: instr.csv");
  }

  instr_samples = 0;
  while (ifile_ins.peek() != '\n') {
    getline(ifile_ins, sinstr_line, ',');
    sscanf(sinstr_line.c_str(), "%llu", &sinstr[instr_samples]);
    instr_samples++;
  }
  cout << "instr_samples: " << instr_samples << endl;
  ifile_ins.close();
  // FIXME: Adjusting EXCERPT_LEN paramete
  EXCERPT_LEN = 11000000;
#endif

#ifdef PRINT_SAMPLES
  if (fg_name == "bodytrack") {
    uint64 scycle_t[] = {10452368,20923436,31397972,41875248,52347960,62823108,73299480,83775832,94256612,104727380,115150912,125680784,136156748,146629404,157103256,167578836,178056284,188531348,199012060,209481328,219956204,230433544,240907588,251385708,261859828,272337424,282759276,293287752,303780664,314237160,324715192,335190268,345666512,356138188,366612148,377092368,387565220,398045368,408518700,418938996,429468300,439943280,450416600,460893508,471370024,481845184,492319852,502805408,513268264,523746012,534221064,544646440,555173264,565646228,576122920,586598588,597081156,607555680,618025124,628450116,638930924,649448252,659925772,670401948,680876572,691353352,701783508,712302604,722766128,733258320,743731088,754208644,764684836,775159996,785635268,796115000,806584404,817059204,827486040,838013944,848488220,858956868,869437312,879908316,890387408,900866116,911338152,921812792,932287644,942764536,953238048,963662924,974191744,984662756,995146768,1005620660,1016119932,1026522636,1036995456,1047469204,1057944820,1068417560,1078895232,1089371220,1099854816,1110323104,1120796648,1131271912,1141748036,1152222568,1162703728,1173170924,1183649128,1194132436,1204601080,1215078160,1225553364,1236028416,1246503232,1256978464,1267454360,1277929388,1288404280,1298878280,1309356372,1319831956,1330307400,1340782172,1351258624,1361732976,1372208984,1382683056,1393164388,1403640076,1414110012,1424586832,1435110032,1445585188,1456013480,1466536292,1477010996,1487484336,1497911120,1508425064,1518911664,1529387508,1539864368,1550336788,1560812888,1571285916,1581762128,1592242876,1602715600,1613189008,1623665824,1634141580,1644617496,1655090784,1665572004,1676041612,1686523948,1696992128,1707467372,1717948204,1728420996,1738893140,1749370964,1759845184,1770323980,1780798464,1791280092,1801751000,1812222836,1822698936,1833174424,1843651112,1854123828,1864602440,1875077268,1885560848,1895978716,1906506492,1916983068,1927460848,1937931564,1948406956,1958884244,1969357016,1979833252,1990316036,2000785988,2011256860,2021746760,2032218480,2042685504,2053110224,2063662012,2074199456,2084680460,2095140156,2105622348,2116096840,2126514628,2137047840,2147405720,2157998000,2168469808,2178946460,2189425492,2199897336,2210373568,2220846756,2231320008,2241798788,2252276108,2262729008,2273171356,2283710660,2294171296,2304652060,2315078964,2325605300,2336078756,2346552184,2357027248,2367513180,2377925884,2388484608,2398930112,2409401240,2419823476,2430280444,2440751644,2451228856,2461702264,2472176524,2482653164,2493135640,2503603388,2514077804,2524554048,2535031736,2545503288,2555979800,2566459628,2576932692,2587413700,2597884856,2608355696,2618836272,2629310188,2639783916,2650259568,2660734812,2671210428,2681684776,2692169560,2702637716,2713113632,2723587064,2734066120,2744540096,2755014644,2765491024,2775967644,2786396132,2796916256,2807393020,2817867496,2828292892,2838818740,2849292576,2859769512,2870246684,2880719112,2891197380,2901672248,2912145656,2922621112,2933100296,2943577976,2954051412,2964525520,2975001420,2985486004,2995951648,3006427408,3016902384,3027374800,3037856768,3048329908,3058808704,3069287216,3079764328,3090237652};
    uint64 sinstr_t[] = {23155808,35261164,44517667,54050379,63907993,73583109,83301676,93157607,103017468,112525741,122453015,132523580,142591359,153069756,163562098,174104716,184374658,194522259,204885392,214916424,225381482,235639844,246395946,256482597,267117148,277810868,288501313,299022495,309671938,320276118,331418520,341786131,352468599,363385325,373836530,384272849,395235088,405859371,416735835,427158931,437853210,448365256,459692804,470786984,481733843,492198928,503645753,514700960,526008971,536782526,548556631,560164005,570731577,582469597,593916181,604973365,616382475,628175219,639426494,651013854,661791027,672860813,683679129,695672803,706118165,718336367,729603807,741679364,753262160,764704929,777659108,788559433,800679121,812009552,823504010,835317052,849154361,859385192,867367825,877359480,887512544,903448777,916839670,928011652,937954579,949741284,961612168,973386794,985460133,995457975,1005487404,1015718067,1026882750,1038610796,1059651160,1069622877,1078547298,1096352630,1104255324,1112909425,1121198434,1128572559,1138104593,1146775123,1157335919,1167263552,1176532044,1185475591,1195658255,1205107557,1213245003,1227310702,1236846075,1246385840,1258247932,1269612877,1278633207,1287998974,1301356551,1308365950,1317442254,1327369620,1335225051,1348155977,1359897661,1368101507,1383681960,1392139112,1401541898,1411034676,1418975592,1427704330,1436091655,1443743267,1459235455,1482817113,1513412504,1541771092,1571341660,1604975094,1640891821,1674308862,1710093397,1743604694,1779683647,1793847683,1806408024,1830064577,1853826108,1877621530,1901424201,1925253792,1949108243,1972937829,1996733195,2020552167,2044415091,2063121070,2070145123,2080355364,2104111561,2127791189,2151567408,2175388473,2199175298,2222952853,2246740320,2270526485,2294331316,2318113583,2341798269,2352739550,2368735745,2392545383,2416345647,2440177018,2464036513,2487867459,2511677455,2535512765,2559082038,2582226078,2605282367,2625002732,2634149347,2655727882,2678978618,2702233719,2725281489,2748060234,2771722917,2795488417,2819288240,2843085554,2866732848,2890330231,2905933213,2917233429,2941018201,2964897203,2988782454,3012515977,3036203008,3060152940,3083752934,3107866521,3131675004,3155569224,3179153824,3189031345,3207355790,3231114215,3254912399,3278693028,3302465625,3326178299,3349883207,3373856720,3397555056,3421333852,3444991934,3467873790,3496177442,3522644402,3546247043,3580951110,3615343730,3651074375,3685738789,3721168994,3755876990,3791147668,3821809854,3840871435,3865309327,3889859026,3914377284,3938930092,3963430391,3987964602,4012554490,4037031901,4061498839,4085959980,4097884296,4113645431,4137991244,4162557056,4187095798,4211648206,4236175336,4260738640,4285233031,4309807194,4334254297,4358790391,4380815137,4400935251,4425493776,4450132690,4474735367,4499274210,4523837102,4548418659,4571407024,4595849274,4620466819,4645097586,4665090730,4687546560,4712363792,4737028885,4761738435,4786427448,4811080198,4835752035,4860476112,4885114929,4909816226,4934132028,4952185445,4976574646,5001059710,5025567662,5050084996,5074590594,5099099825,5123614592,5148120522,5172608775,5196471217,5217571020,5249546269,5279174830,5292474585};
    SAMPLE_LEN = 295;
    EXCERPT_LEN = 10000000;
    // Below : original offline data
    //uint64 scycle_t[] = {9543516, 19841328, 30141624, 40439484, 50739044, 61035260, 71331940, 81634352, 91930296, 102228584, 112523568, 122824300, 133119948, 143417628, 153716640, 164018748, 174314712, 184608660, 194909616, 205207372, 215506212, 225801212, 236104096, 246400968, 256698304, 266991868, 277291536, 287591752, 297885736, 308190092, 318486484, 328781212, 339082572, 349377020, 359678064, 369974892, 380274688, 390568040, 400866668, 411166656, 421466968, 431763144, 442059996, 452359380, 462655432, 472952604, 483254144, 493551460, 503848072, 514150264, 524442208, 534743236, 545040912, 555338496, 565636876, 575932832, 586233456, 596528492, 606830392, 617127224, 627425168, 637719872, 648020192, 658316188, 668615584, 678916252, 689208944, 699506268, 709806252, 720107064, 730401308, 740698036, 750999184, 761296560, 771591680, 781891568, 792194212, 802486964, 812784788, 823082304, 833381744, 843680572, 853975004, 864278724, 874575116, 884874904, 895170832, 905468720, 915764552, 926067336, 936365064, 946659332, 956960224, 967253048, 977552004, 987850672, 998154152, 1008449644, 1018746816, 1029041328, 1039342992, 1049640712, 1059939716, 1070234400, 1080534176, 1090828220, 1101128372, 1111427940, 1121726780, 1132024820, 1142325932, 1152620384, 1162917212, 1173224904, 1183513564, 1193812432, 1204110928, 1214407732, 1224706744, 1235001644, 1245308500, 1255598292, 1265898320, 1276194376, 1286494032, 1296792072, 1307085456, 1317387668, 1327683136, 1337980728, 1348280700, 1358576600, 1368879004, 1379174048, 1389509972, 1399810308, 1410109952, 1420406124, 1430704376, 1441004568, 1451300448, 1461597172, 1471905092, 1482202080, 1492492868, 1502790816, 1513091964, 1523386268};
    //uint64 sinstr_t[] = {14104424, 36477401, 58891159, 81294777, 103704169, 126119502, 148552157, 170991450, 193389312, 215807068, 238218512, 260623109, 280137757, 297946121, 320360318, 342798714, 365237509, 387666784, 410099186, 432528642, 454973035, 477380639, 499835898, 522266484, 544692457, 560955778, 582582973, 605034365, 627482405, 649938718, 672372370, 694818298, 717283472, 739723470, 762185066, 784639765, 807098385, 827384525, 844571269, 867023979, 889520909, 911970246, 934426240, 956891040, 979343598, 1001816217, 1024283362, 1046760940, 1069231924, 1091703701, 1108886022, 1129561142, 1151965032, 1174366445, 1196783158, 1219184816, 1241594589, 1263996925, 1286418428, 1308823101, 1331233852, 1353617004, 1375215225, 1386961593, 1399695161, 1412647508, 1425423069, 1438360555, 1448033677, 1467500597, 1494411519, 1516489103, 1539559362, 1565861927, 1585304075, 1611680885, 1636603205, 1656046108, 1683085023, 1704127214, 1722093890, 1744499266, 1766925342, 1789371330, 1811796194, 1834210694, 1856631380, 1879061753, 1901476333, 1923873738, 1946290770, 1968704774, 1985114295, 2006435401, 2028880044, 2051329219, 2073776551, 2096218277, 2118659448, 2141070429, 2163539390, 2185951802, 2208383162, 2230817441, 2251558258, 2268270409, 2290719403, 2313207217, 2335672602, 2358123934, 2380593052, 2403036551, 2425496306, 2447977090, 2470390017, 2492857026, 2515322795, 2533033513, 2553201241, 2575678132, 2598182441, 2620650770, 2643123773, 2665586969, 2688058567, 2710521032, 2732998071, 2755464179, 2777972386, 2799685654, 2815418789, 2837827101, 2860268180, 2882676945, 2905181696, 2927604775, 2950017939, 2972413618, 2994826302, 3017233573, 3039690984, 3062127452, 3079743373, 3092748559, 3105802746, 3117828224, 3130803083, 3141267010};
    //SAMPLE_LEN = 148;
    //EXCERPT_LEN = 11000000;

    uint64 sum_scycle = 0;
    uint64 sum_sinstr = 0;
    for (int i=0; i<SAMPLE_LEN; i++) {
      scycle[i] = scycle_t[i]; sinstr[i] = sinstr_t[i];
      sum_scycle += scycle_t[i];
      sum_sinstr += sinstr_t[i];
    }
  }

  else if (fg_name == "freqmine") {
    uint64 scycle_t[] = {10457296,20934504,31407104,41835556,52313084,62833276,73309872,83736628,94278440,104741780,115215040,125695704,136164688,146638404,157124400,167597808,178064832,188544192,199029336,209492984,219970064,230446200,240921568,251391760,261868232,272341668,282821908,293297792,303784928,314247748,324723360,335202544,345673508,356146032,366624752,377098128,387576372,398070952,408528424,419004940,429479136,439957008,450376004,460898544,471378616,481854876,492276848,502810872,513278620,523757712,534233488,544708604,555181596,565657272,576082596,586606376,597092396,607559400,617982384,628509956,638987508,649466116,659937616,670411372,680892644,691361196,701862672,712314864,722789828,733274780,743751352,754221756,764692732,775166004,785604712,796126160,806595668,817067396,827546632,838019712,848497792,858967240,869394376,879919856,890399724,900882976,911295196,921824976,932302400,942779888,953249704,963724196,974200568,984679700,995169424,1005578792,1016128664,1026586572,1037002784,1047535196,1057970976,1068432244,1078909716,1089440216,1099922960,1110393212,1120854260,1131337188,1141807568,1152288200,1162705336,1173185264,1183709964,1194198704,1204608620,1215137372,1225611876,1236085964,1246563956,1257036712,1267518208,1277992596,1288415180,1298936924,1309416624,1319893604,1330364892,1340842988,1351319332,1361797132,1372270000,1382743544,1393230300,1403703688,1414121076,1424644180,1435123520,1445596416,1456018764,1466541404,1477023288,1487494948,1497922032,1508448552,1518926016,1529396056,1539882872,1550349168,1560837532,1571310436,1581777084,1592262988,1602741448,1613199920,1623624920,1634164896,1644629004,1655054496,1665578024,1676052972,1686545568,1697005084,1707485956,1717956744,1728434248,1738904828,1749385848,1759856784,1770331300,1780759628,1791293728,1801758760,1812237088,1822712540,1833185044,1843664904,1854136548,1864612896,1875092044,1885574644,1896040424,1906517468,1916997868,1927417568,1937944328,1948423992,1958893900,1969370636,1979846412,1990278116,2000744284,2011270892,2021742624,2032218148,2042694924,2053117608,2063644148,2074120800,2084609164,2095073272,2105548896,2116021472,2126504196,2136975724,2147453308,2157878984,2168406668,2178876264,2189361472,2199830808,2210256228,2220775904,2231255680,2241737692,2252203848,2262676560,2273153972,2283650240,2294112020,2304588240,2315065312,2325534496,2336008652,2346488144,2356908308,2367442768,2377911240,2388417280,2398869244,2409342808,2419816448,2430293488,2440771836,2451245532,2461724308,2472193792,2482666488,2493158896,2503578556,2514101216,2524587776,2535053836,2545529168,2556007240,2566477520,2576958256,2587432948,2597905380,2608379920,2618846968,2629323552,2639799720,2650271924,2660749908,2671224756,2681701656,2692184640,2702650152,2713123416,2723550928,2734078988,2744553720,2755027288,2765502120,2775975520,2786459664,2796929076,2807403236,2817876116,2828358044,2838833312,2849309196,2859787136,2870262596,2880732588,2891222396,2901686416,2912157556,2922634344,2933113440,2943587372,2954059952,2964551884,2975009112,2985495524,2995965260,3006439704,3016915992,3027386880,3037866360,3048336488,3058796020,3069292712,3079766384,3090254844,3100662892,3111190868,3121667944,3132090904,3142618044,3153094672,3163569144,3174041104,3184483988,3194953612,3205427512,3215881940,3226420504,3236892916,3247375472,3257852204,3268327548,3278801620,3289237600,3299703148,3310231280,3320708356,3331178632,3341606940,3352127184,3362607924,3373078584,3383512664,3394026604,3404502680,3414981416,3425468572,3435942680,3446415644,3456835268,3467365844,3477784472,3488321948,3498783152,3509259960,3519733008,3530210652,3540684436,3551161968,3561639408,3572066884,3582598352,3593064744,3603541224,3614016068,3624492296,3634968560,3645436564,3655918292,3666388320,3676847316,3687355952,3697823256,3708296056,3718769352,3729244276,3739668656,3750209364,3760671624,3771148348,3781630876,3792098308,3802575488,3813056604,3823525224,3833999420,3844475764,3854952376,3865428508,3875901608,3886381548,3896852284,3907327588,3917803220,3928277112,3938753640,3949231488,3959705032,3970179684,3980663264,3991133052,4001609372,4012082108,4022511168,4033035776,4043506136,4053981480,4064460452,4074937584,4085422720,4095887316,4106361520,4116840192,4127313340,4137784348,4148213520,4158737480,4169212824,4179695612,4190166196,4200644032,4211115916,4221593264,4232071056,4242542320,4253017840,4263499840,4273966292,4284459888,4294927824,4305401088,4315881536,4326354220,4336833900,4347300752,4357729536,4368249516,4378729160,4389200152,4399676312,4410155156,4420625312,4431057968,4441579408,4452053524,4462479268,4473002048,4483490428,4493955452,4504431568,4514903896,4525380608,4535858176,4546331404,4556807036,4567277688,4577765112,4588231976,4598677232,4609183396,4619666488,4630141040,4640617880,4651087112,4661564120,4672048808,4682531328,4692993516,4703460836,4713886916,4724416336,4734839840,4745388516,4755841764,4766262552,4776796724,4787263436,4797745388,4808218128,4818692584,4829168712,4839641896,4850115308,4860596144,4871066436,4881548904,4892026416,4902495664,4912972340,4923446880,4933926508,4944401324,4954879940,4965352940,4975833676,4986306964,4996785732,5007255464,5017730124,5028198676,5038678396,5049158112,5059627512,5070107184,5080531604,5091060580,5101535184,5112012960,5122483408,5132960752,5143440348,5153910232,5164385580,5174867012,5185331628,5195818712,5206232996,5216708132,5227199216,5237660176,5248138124,5258613816,5269099572,5279564024,5290039348,5300517468,5310991648,5321468396,5331946824,5342420752,5352893724,5363416700,5373906804,5384371744,5394845644,5405317656,5415796216,5426270340,5436752264,5447221888,5457698944,5468183572,5478651900,5489121128,5499612948,5510073668,5520550568,5531034472,5541513116,5551980292,5562450352,5572935056,5583410324,5593883332,5604302692,5614832276,5625305576,5635787796,5646255864,5656736160,5667222552,5677688612,5688159100,5698579824,5709113696,5719586184,5730059108,5740530544,5751009444,5761438524,5771975644,5782436676,5792912732,5803386336,5813814644,5824338376,5834815276,5845290360,5855765280,5866255064,5876718608,5887194376,5897616392,5908146536,5918570452,5929097252,5939565436,5950048828,5960527328,5970956588,5981479764,5991951156,6002425832,6012905172,6023373736,6033802312,6044326724,6054801116,6065283768,6075750236,6086226796,6096715144,6107174284,6117669656,6128140624,6138553132,6149079264,6159507984,6169995948,6180510632,6190938040,6201454512,6211930908,6222405448,6232879352,6243357104,6253846776,6264318788,6274782112,6285259492,6295733576,6306211584,6316689284};
    uint64 sinstr_t[] = {22158116,34320520,43734954,53090423,62565884,72151746,81739245,91419416,101157931,110536506,120362109,130228894,140167096,150438249,160774609,171362447,181376842,191070413,201189040,211088698,221675989,231751381,242588035,252599628,262892695,272909266,283734820,294285210,304898795,315690235,326013269,336533807,347256986,357547769,368223194,378854135,388944974,399877441,410502168,420901576,431622034,441746717,452676959,463820553,474675797,485408475,496120060,507580732,518327349,529282584,540676318,552198238,563084910,574710203,585602780,596382380,608088464,619524151,630579047,642203035,653743588,664293763,675818101,687479071,698223346,710235022,721910947,733622245,745730864,756459238,768647577,780729513,792573647,804877173,816109414,828688662,842716188,853156419,861201479,871076541,879532556,896172867,910063103,921315642,931704156,943491723,955252702,967130992,979184602,989064314,999121196,1009454979,1020691385,1031803216,1052609615,1062018635,1070400084,1082352613,1095984157,1104490071,1111563692,1118096709,1127256051,1135195634,1143694413,1155291255,1164028888,1173917254,1182096778,1192358675,1201652767,1212294547,1225672122,1234507493,1245268865,1257960313,1267817347,1276653043,1287455141,1298014894,1306359250,1316936135,1325056590,1335947290,1348627763,1358188376,1370090235,1381606502,1390582798,1401079027,1410033478,1418295792,1427406906,1436640796,1445720323,1453926898,1461789340,1480505032,1500400339,1520752758,1541070901,1561076961,1581193348,1601550152,1622082801,1642420591,1662699532,1682985005,1703287017,1723146085,1743408396,1763722490,1784045212,1804364167,1824551043,1845113339,1865447914,1885714048,1906154999,1926516358,1946816898,1967194107,1987540044,2007824215,2028071835,2048498939,2068885470,2089210242,2109657233,2129875686,2150374177,2170744392,2191152628,2211434008,2231722220,2252124822,2272460296,2292850912,2313196117,2333516613,2353759643,2373982820,2394307489,2411156988,2422587809,2434717330,2450153869,2467498652,2484637277,2501764780,2518846285,2535183801,2552337209,2569477580,2586563745,2603663523,2620819565,2637845398,2655089963,2670502165,2687643593,2704726382,2721819054,2738692709,2755654047,2772695142,2789717369,2806864567,2823941986,2841031043,2857986453,2875286438,2890855685,2907990363,2925241096,2942449221,2959666028,2982786951,2990449846,2998765487,3002419379,3006994190,3010981382,3017607126,3024080801,3031270831,3039195693,3049467638,3060001911,3071319153,3083131360,3093537030,3103759753,3112828251,3119597016,3122259389,3128097038,3133810524,3139746938,3145449054,3151479600,3157487072,3163617149,3169705153,3175836542,3182081375,3191177789,3209284158,3228382276,3246274767,3263660340,3282951129,3303761754,3323614167,3345623678,3367890509,3388796954,3411045883,3431635801,3450989481,3471167930,3493543796,3517478445,3540819205,3562079558,3582632375,3603802123,3626556403,3650809070,3673719346,3697102840,3720172204,3741742054,3763272448,3785427731,3806684203,3829528134,3853660910,3878238556,3902631181,3925983188,3949818404,3973849538,3997416755,4021669361,4043360004,4065134460,4084089268,4105566551,4127984316,4150858843,4172865284,4193352274,4215319782,4236001959,4257496283,4278949019,4301668251,4323877481,4348726513,4373116176,4396270816,4419688158,4442104965,4463120819,4484590664,4505772034,4528103990,4551974160,4575655005,4599033513,4622827203,4645360496,4668499875,4692458207,4715730733,4738392523,4759479616,4782661656,4805693947,4829350855,4853937562,4877337377,4900476818,4924048899,4946714529,4970345909,4994478827,5018416429,5040888482,5063637526,5086201501,5108839756,5131479285,5155121928,5179770389,5201371879,5223824728,5246128651,5268940624,5289652614,5312259768,5336300260,5359544838,5381930103,5405021566,5427895830,5450969950,5474335936,5498181325,5522327145,5542324786,5564636838,5587745336,5611081443,5634791075,5658563490,5682748879,5707019413,5729890840,5752111303,5775318374,5799309298,5823315108,5846923738,5869042492,5891792105,5915704466,5939836954,5961544158,5985548416,6006659790,6029360868,6053740940,6075591734,6098407116,6122384648,6144808874,6167819025,6190888679,6213904403,6237594495,6261478455,6281292005,6304457837,6325733814,6348160946,6369635745,6391110213,6412064047,6434932045,6456610915,6477432617,6500513417,6524039962,6546955197,6568972130,6591215397,6612273136,6634575388,6656904374,6679852540,6699271793,6720296694,6741398636,6762312835,6780188772,6798170687,6816039292,6836055509,6858079006,6882169739,6905804400,6930724005,6954643853,6977491086,6998918399,7021915715,7044445417,7066824129,7087553826,7110206682,7131281201,7153229032,7175911003,7197735940,7220011541,7243780644,7263664081,7286608738,7310375428,7333215199,7356213616,7379517125,7402910544,7426071153,7448787855,7471745368,7493643272,7515957827,7538033387,7559741686,7582319457,7603226936,7624075045,7643452700,7665341950,7688591102,7711596139,7733693048,7755913522,7776938210,7797067777,7816639749,7838971147,7861768140,7883355983,7902790147,7923266463,7946458932,7971513739,7996440261,8019125269,8040837510,8064081660,8087041171,8108172589,8130262634,8151066568,8171243831,8191599659,8211674987,8230607456,8250693554,8270766332,8290471554,8309633507,8327798707,8346200051,8369381473,8391268056,8407213112,8422531069,8439026547,8455515352,8472437859,8489678046,8508717033,8530088295,8546933653,8563154092,8577975509,8592799248,8609593869,8630701086,8655303891,8679261968,8705112194,8729492137,8749147833,8767904495,8792005265,8817075019,8838759295,8861986817,8882740786,8897962311,8919858363,8939188578,8951647324,8965604773,8980038920,8993928502,9007589311,9020765138,9033898959,9047535839,9061106349,9076567236,9090260808,9103231774,9115270577,9127861997,9140101519,9152704778,9165152324,9177571392,9189920198,9201044594,9213363729,9226413631,9239186673,9250029727,9262700963,9275222553,9286007859,9300428470,9310707080,9325733599,9337852909,9351676855,9362957655,9377283987,9387802300,9402708193,9416400127,9428288555,9443299447,9456310054,9467308487,9481142977,9495730844,9510119567,9522353730,9534018164,9547272332,9561404315,9575216013,9587774845,9602282363,9613285738,9628055307,9640330257,9653672470,9666914443,9680600312,9695524059,9708876046,9721490877,9735497719,9746675496,9760308086,9773489072,9786006001,9798839327,9812914449,9826360325,9839401246,9851089602,9863271417,9877206300,9889306832,9900472260,9912262592,9925358805,9937568038,9950762440,9963468688,9976262364,9988109044,10002012523,10013483152,10026379973,10039758474,10051392346,10064550179,10076728300,10088845773,10101480436,10114010383,10125904146,10137914183,10149567509};
    SAMPLE_LEN = 603;
    EXCERPT_LEN = 20000000;
    for (int i=0; i<SAMPLE_LEN; i++) {
      scycle[i] = scycle_t[i]; sinstr[i] = sinstr_t[i]; }
  }

  else if (fg_name == "fluidanimate") {
    uint64 scycle_t[] = {10454708,20930792,31406496,41878856,52358276,62830216,73310072,83783480,94265052,104733576,115204696,125679400,136156472,146633692,157112768,167585672,178059404,188536632,199022860,209486468,219959056,230437608,240926908,251395172,261863184,272339744,282815264,293293032,303728936,314242156,324718828,335192568,345669580,356145584,366620600,377095304,387573156,398051284,408523140,419000124,429468888,439946052,450423416,460899024,471378432,481850572,492322868,502815296,513289424,523754124,534224348,544701152,555181160,565650568,576131428,586602228,597089280,607563112,618030112,628510232,638979364,649457644,659927868,670406788,680881604,691359180,701851764,712312652,722784404,733267316,743744616,754218200,764689156,775165988,785645688,796122108,806598776,817070616,827550656,838015140,848492616,858965340,869438840,879916336,890394540,900882572,911343652,921823316,932293456,942776032,953248100,963722124,974185272,984673272,995143800,1005617484,1016059436,1026521932,1037000796,1047473952,1057949536,1068429256,1078900112,1089378724,1099865028,1110329124,1120801108,1131276492,1141750384,1152230324,1162715044,1173183188,1183653176,1194139688,1204603388,1215080568,1225557668,1236032924,1246506012,1256982768,1267456720,1277931776,1288404800,1298886188,1309359736,1319833860,1330312316,1340787060,1351261356,1361738220,1372213480,1382689000,1393171496,1403639920,1414119796,1424589260,1435066436,1445536028,1456014824,1466489000,1476967064,1487439912,1497913212,1508393120,1518864700,1529338356,1539821868,1550291096,1560766384,1571242040,1581720512,1592206704,1602670128,1613156512,1623632088,1634095492,1644576628,1655059668,1665534948,1676002768,1686494972,1696952524,1707428456,1717903876,1728379040,1738855548,1749331220,1759802224,1770281972,1780757844,1791240192,1801706628,1812183796,1822665756,1833128892,1843605932,1854082408,1864560092,1875031140,1885513256,1895987040,1906463156,1916932608,1927411560,1937885036,1948360068,1958840828,1969311784,1979789916,1990322552,2000788324,2011267048,2021741536,2032209368,2042683668,2053155860,2063596856,2074124524,2084601388,2095066728,2105541648,2116017068,2126494300,2136972816,2147446500,2157926632,2168396224,2178870844,2189355360,2199823428,2210302232,2220768956,2231251080,2241728408,2252202116,2262673512,2273109352,2283648812,2294105324,2304584280,2315057496,2325525512,2336001432,2346479760,2356951380,2367428200,2377860392,2388406592,2398860192,2409339072,2419821148,2430284668,2440761540,2451237660,2461713408,2472136348,2482664176,2493155148,2503612376,2514093724,2524572956,2535054068,2545525220,2555995780,2566424052,2576937736,2587433444,2597888548,2608365372,2618849628,2629317876,2639738572,2650221572,2660752172,2671219392,2681696948,2692180956,2702647636,2713117796,2723593548,2734069360,2744544412,2755023100,2765496520,2775976780,2786467716,2796935384,2807397000,2817878396,2828353696,2838829968,2849305996,2859781616,2870204132};
    uint64 sinstr_t[] = {22978605,35219511,44692439,54331279,63929416,73694898,83548708,93287925,103085607,112595585,122645312,132579796,142724108,153048815,163637446,174116779,184368586,194497093,204890299,214961408,225887324,236206592,246505847,256649546,267238143,277961234,288854700,299245464,310137309,321039844,331835066,342050727,352799250,363638309,374333531,384670965,395448671,405979529,417020574,427357950,438398615,448732579,460050944,471267490,482225368,493566394,504188783,515298411,526704773,538268742,549132309,560813743,572153746,583772880,594841403,606017614,617961677,628891124,640526544,652112926,662657423,674358546,685554251,696903393,709029525,721091087,732581559,744349251,756998451,767981593,780251112,792527500,803893985,817125155,828518716,841030551,855400394,863362450,873812140,882631496,898129021,911652138,923588564,934475831,946744716,957881451,968647629,979697092,989124979,999588182,1008776986,1017004423,1027732494,1039937821,1059813500,1068668345,1079979740,1096477584,1106143883,1114559988,1122097998,1131772426,1139954160,1148300930,1159573593,1169312280,1178178129,1187348604,1197114996,1206382499,1215788156,1228263843,1238156790,1247966246,1262132667,1271163950,1280142714,1289683243,1302180101,1310358182,1318874988,1327756827,1338224215,1350558537,1361451845,1369383923,1385132331,1393716118,1402864042,1412220355,1420410024,1429400977,1436941056,1442647883,1452283434,1478786138,1479841282,1480255316,1480667761,1481971979,1502648547,1526725917,1550564471,1574045206,1598004632,1621918036,1633455615,1638496100,1646663206,1672079465,1703919949,1735682363,1767174537,1798996965,1830643591,1862129115,1892886560,1919985659,1949022780,1977677605,2006312230,2034926267,2063680901,2092758787,2121369194,2150123862,2178797919,2207712481,2234099868,2245966366,2248254142,2257917065,2267731458,2299293984,2330971795,2362656364,2394213404,2425862111,2457408843,2488785917,2517897279,2546306596,2574843143,2603474331,2632625265,2661350896,2689809443,2718196746,2746846022,2775341239,2803862561,2832877174,2853298774,2862175841,2864690228,2874867031,2892596893,2923438282,2954186070,2982504071,3013382440,3044314616,3075145404,3105757493,3134846387,3163008472,3191529214,3219955627,3248939944,3277273284,3305609796,3334593808,3363139259,3391670754,3420108685,3448724727,3473721961,3485584788,3487198032,3497529529,3508379425,3538625888,3568949702,3599613030,3629941346,3660426819,3690844038,3721359390,3750957513,3778663348,3807119344,3835070777,3863240912,3891534479,3919742887,3947907310,3975957782,4004733688,4032783896,4060753507,4088901439,4106387962,4113531675,4117837106,4126521688,4149655095,4180408643,4211090909,4241954155,4272880486,4303678199,4333974990,4364866623,4393422654,4421723500,4448795410,4477049930,4505878864,4534008057,4562001233,4590658898,4618922091,4647062545,4675271471,4703937719,4728379050,4740110129,4768396232,4797685605,4827172371,4856861300,4886317807,4909181898,4918439819};
    SAMPLE_LEN = 274;
    EXCERPT_LEN = 10000000;
    for (int i=0; i<SAMPLE_LEN; i++) {
      scycle[i] = scycle_t[i]; sinstr[i] = sinstr_t[i]; }
  }

  else if (fg_name == "canneal") {
    uint64 scycle_t[] = {10450912,20927156,31401216,41873516,52351508,62827548,73300556,83777272,94268360,104739868,115208224,125687616,136105548,146632736,157106864,167585592,178060632,188539772,199021124,209485528,219959972,230434724,240906608,251381928,261858896,272332956,282809716,293285276,303768860,314236840,324713980,335189340,345662144,356136616,366612648,377089656,387564752,398052744,408513884,418992080,429466160,439942140,450423440,460893020,471376592,481847348,492274700,502755820,513227972,523745220,534225200,544700644,555176612,565653820,576131420,586607320,597085928,607549644,618041040,628505760,638993876,649451192,659927884,670405828,680878208,691359856,701836568,712305432,722782656,733253744,743731856,754203548,764681660,775159112,785636876,796120092,806583040,817061340,827537060,838011348,848492324,858960872,869433456,879902424,890391080,900871376,911342416,921816128,932290128,942767376,953188788,963717436,974191736,984675180,995154628,1005619508,1016038508,1026571404,1037050560,1047520256,1057999328,1068477572,1078891244,1089418668,1099901304,1110370792,1120847764,1131342556,1141797424,1152279032,1162757176,1173226432,1183702036,1194183052,1204654008,1215130572,1225600808,1236080440,1246557724,1257031076,1267506456,1277983272,1288457056,1298929752,1309412192,1319883820,1330357973,1340836289,1351310701,1361782853,1372257113,1382735633,1393224041,1403687645,1414161045,1424640481,1435125265,1445590141,1456073625,1466537493,1477014461,1487485929,1497964545,1508445621,1518865397,1529398257,1539876229,1550342389,1560765281,1571247377,1581775713,1592253081,1602672653,1613196885,1623670709,1634145765,1644625485,1655094405,1665571377,1676002173,1686532257,1697002237,1707475757,1717951453,1728426393,1738906833,1749383761,1759856041,1770326421,1780805005,1791295437,1801753413,1812229521,1822701049,1833177561,1843655037,1854130517,1864603853,1875084445,1885568053,1896034325,1906507037,1916982933,1927464349,1937935813,1948407173,1958884405,1969363101,1979833081,1990320605,2000786521,2011263157,2021683413,2032214085,2042685861,2053185441,2063593029,2074062021,2084546353,2095018981,2105489493,2115968441,2126444073,2136918981,2147391625,2157866801,2168342025,2178819257,2189303381,2199768381,2210246681,2220722489,2231195069,2241671521,2252146261,2262622773,2273098537,2283581061,2294049521,2304541393,2315003273,2325486521,2335952437,2346432161,2356904441,2367383001,2377851253,2388363641,2398827321,2409277545,2419762885,2430244781,2440715137,2451185181,2461666125,2472133217,2482608129,2493093413,2503563269,2514039397,2524510553,2534988813,2545457825,2555933929,2566410601,2576884237,2587368761,2597839433,2608314989,2618790789,2629266177,2639744021,2650270089,2660736869,2671215993,2681687073,2692173301,2702638769,2713115649,2723592341,2734019429,2744540521,2755020093,2765493729,2775980913,2786452293,2796922533,2807396245,2817873937,2828295533,2838824253,2849304317,2859776001,2870254169,2880731497,2891209709,2901662401,2912150465,2922631941,2933104509,2943576765,2954052357,2964530785,2975003977,2985492733,2995950749,3006426857,3016904213,3027381261,3037854389,3048329525,3058810053,3069286453,3079755129,3090240905,3100710289,3111172665,3121664685,3132134821,3142611097,3153084041,3163564293,3174039605,3184526453,3194987513,3205464401,3215942897,3226415929,3236844709,3247366761,3257841145,3268327609,3278753321,3289288029,3299775761,3310227057,3320706017,3331176641,3341654161,3352127333,3362596421,3373070913,3383562181,3394027869,3404496045,3414976081,3425449401,3435930521,3446400893,3456880601,3467352797,3477825997,3488311533,3498779641,3509252773,3519727853,3530206525,3540678329,3551153753,3561628037,3572107477,3582587717,3593055833,3603532457,3614009233,3624487965,3634961973,3645440253,3655917269,3666393849,3676862965,3687358153,3697811273,3708287861,3718765849,3729243533,3739714809,3750187701,3760659349,3771142809,3781625873,3792088341,3802563237,3813037793,3823519577,3833993373,3844467857,3854944501,3865421449,3875896109,3886375905,3896843281,3907320357,3917798933,3928269617,3938745177,3949227933,3959697545,3970169657,3980657753,3991129165,4001599881,4012077945,4022554473,4033028105,4043501593,4053978341,4064453941,4074930305,4085411253,4095881561,4106356733,4116847533,4127314549,4137777125,4148216673,4158678013,4169170133,4179648941,4190117909,4200591541,4211060973,4221534393,4232014613,4242494541,4252971377,4263440641,4273921193,4284397857,4294861897,4305339977,4315811961,4326289981,4336765229,4347261425,4357713353,4368189697,4378670705,4389138729,4399620569,4410092609,4420566233,4431040689,4441520113,4451991705,4462467017,4472944617,4483433877,4493895913,4504371089,4514849025,4525320901,4535798637,4546273493,4556750117,4567227653,4577712173,4588174257,4598649085,4609127873,4619599841,4630078053,4640554281,4651028417,4661504633,4671977673,4682459209,4692927301,4703409473,4713880421,4724357593,4734833937,4745309209,4755783653,4766260561,4776792677,4787263405,4797736513,4808209577,4818685449,4829158197,4839634861,4850108301,4860589001,4871066133,4881542013,4892012641,4902491629,4912966961,4923442793,4933918465,4944399845,4954864645,4965343233,4975827469,4986293765,4996773401,5007241693,5017726553,5028194605,5038676845,5049148933,5059636253,5070104945,5080584757,5091062197,5101523157,5112013417,5122483453,5132958253,5143431861,5153915069,5164386969,5174869805,5185334277,5195815633,5206266561,5216754933,5227230901,5237707109,5248186425,5258659493,5269144377,5279612225,5290085313,5300555073,5311036213,5321513709,5331935965,5342456929,5352934829,5363412877,5373847873,5384310641,5394835937,5405316169,5415791353,5426270353,5436738873,5447215621,5457695037,5468176461,5478651737,5489118493,5499602913,5510066049,5520547809,5531024053,5541498305,5551968873,5562447589,5572931105,5583394197,5593878489,5604348477,5614819245,5625303277,5635777557,5646249261,5656725373,5667218397,5677671357,5688149085,5698629381,5709105321,5719576197,5730056137,5740476637,5751004373,5761479165,5771961381,5782428781,5792905453,5803376829,5813860021,5824330457,5834757777,5845283921,5855758593,5866246017,5876707605,5887131413,5897658057,5908138593,5918614457,5929086505,5939562249,5950040917,5960514729,5970999965,5981468313,5991941621,6002421689,6012888285,6023375941,6033847373,6044326941,6054746037,6065282289,6075749701,6086171309,6096696161,6107170741,6117649421,6128066929,6138598013,6149021433,6159547801,6169982357,6180499465,6190973225,6201397941,6211875117,6222401761,6232871989,6243350833,6253776237,6264259093,6274727697,6285201161,6295683917,6306155345,6316626861,6327107765,6337585369,6348050705,6358533757,6369011873,6379484113,6389958121,6400431549,6410911657,6421384829,6431856321,6442336617,6452808113,6463292329,6473758469,6484238053,6494711541,6505190013,6515663493,6526134937,6536615617,6547093621,6557565233,6568047533,6578515317,6588985617,6599464465,6609945577,6620416649,6630889393,6641368501,6651848433,6662325873,6672795749,6683269517,6693745381,6704220473,6714695085,6725171409,6735643985,6746118633,6756583137,6767087829,6777549457,6788030333,6798502713,6808974913,6819452297,6829926161,6840411613,6850881865,6861363985,6871851961,6882316525,6892785589,6903312949,6913762301,6924269181,6934719645,6945212001,6955681853,6966169921,6976638353,6987108385,6997603661,7008057385,7018531737,7029013617,7039489133,7049982669,7060441373,7070912193,7081383085,7091865073,7102331397,7112806561,7123287585,7133761809,7144237657,7154711381,7165195805,7175661437,7186130509,7196616353,7207089281,7217576477,7228044837,7238521341,7248994989,7259487461,7269945437,7280422677,7290843901,7301343301,7311848069,7322321181,7332801493,7343268989,7353747409,7364239925,7374699909,7385174961,7395647933,7406127833,7416601573,7427078957,7437554177,7448030365,7458510321,7468981125,7479453825,7489931329,7500405313,7510884869,7521362205,7531834409,7542309421,7552789241,7563256241,7573732253,7584212661,7594688341,7605155033,7615637185,7626107313,7636591989,7647062069,7657495933,7668013037,7678490073,7688961913,7699437513,7709864309,7720389521,7730864881,7741288481,7751820113,7762291697,7772770565,7783189193,7793717157,7804200001,7814676589,7825149661,7835580525,7846097825,7856586153,7867050717,7877475573,7888000137,7898474493,7908948765,7919375269,7929904249,7940372565,7950857217,7961326213,7971804633,7982272461,7992762385,8003177461,8013718637,8024179569,8034656393,8045079869,8055616833,8066082117,8076564609,8086981349,8097511605,8107979985,8118455689,8128880877,8139412501,8149891161,8160364581,8170851573,8181315933,8191790633,8202268869,8212737877,8223218529,8233683565,8244164673,8254649357,8265118013,8275591597,8286066641,8296493801,8307017817,8317486873,8327965641,8338387625,8348817273,8359344189,8369821305,8380293733,8390774197,8401244917,8411726697,8422198585,8432675725,8443145373,8453631849,8464099833,8474571589,8485047217,8495523133,8506004989,8516481161,8526954101,8537428297,8547910061,8558380269,8568849793,8579326789,8589806289,8600283385,8610755997,8621234205,8631706473,8642183893,8652649565,8663139613,8673616461,8684087053,8694558681,8705039325,8715516653,8725993389,8736460881};
    uint64 sinstr_t[] = {23080452,35226469,44526151,53925980,63700134,73479360,83152295,92897277,102711682,112194661,122168712,132198518,142092758,152404216,162922704,173287940,183396193,193409079,203574901,213708114,224391166,234541663,245545485,255681661,266377644,276624509,287235112,297832666,308599395,319362748,330361107,340519210,351335254,361556874,372394083,383265156,393383392,404286047,414963741,425743093,436658540,446861997,457827229,469206891,480159766,491125674,501365420,512582347,522799716,533750389,545406270,555879850,567487468,578008634,588869888,599591633,610188373,621432607,632775277,643328386,653997007,664358134,675824014,687019013,698363214,710472195,722489783,733937050,745546301,757651910,769197846,781511833,793149991,804935957,817050090,829477495,841639452,856371771,864238780,873995984,881810491,896296252,909741063,921523985,932906227,944481784,955689033,965942007,977703271,988846663,998819472,1008271190,1017963846,1028751329,1040939735,1061155454,1070701756,1078802643,1094581865,1105307532,1114057175,1122415660,1130415121,1139827963,1148298411,1158948622,1168996958,1178318194,1187374609,1197214221,1207012615,1216222279,1229437806,1238665057,1248418403,1262451299,1271806261,1281073280,1290548870,1303073795,1311512529,1320172806,1329218356,1339078331,1352336790,1362413742,1370636875,1386340065,1395008165,1404201596,1413360775,1421451698,1430821105,1439021167,1446874738,1454879283,1462802393,1470694310,1477294744,1485030040,1498550570,1511649823,1524181182,1536389403,1548251984,1559888120,1571221449,1582398825,1593334806,1604154602,1614878159,1625666507,1636381009,1646869158,1657411152,1667769252,1678086350,1688314567,1698585204,1708625668,1718725764,1728200868,1737338823,1746415396,1755429975,1764391207,1773361850,1782278944,1791153203,1800206133,1809244100,1818584615,1828022215,1837260616,1846650038,1855919240,1865238890,1874583022,1883617851,1892639038,1901532114,1910584851,1919679017,1928647852,1937679836,1946651838,1955617436,1964552042,1973506259,1982392316,1991167608,1999964908,2008672047,2017301051,2025962558,2034555024,2042920700,2051393093,2059964552,2068531997,2077064919,2085531144,2093999233,2102458006,2110909647,2119270740,2127687776,2136138364,2144566732,2152931006,2161225027,2169480770,2177767019,2185922075,2194186148,2202350492,2210537094,2218598408,2226763626,2234874288,2242992824,2251058099,2259108450,2267200643,2275206060,2283223025,2291250068,2299263134,2307203583,2315204757,2323191644,2331141778,2339026650,2346872398,2354726544,2362598791,2370515080,2378346509,2386139481,2393970666,2401757741,2409533005,2417288639,2425072338,2432799177,2440544468,2448257819,2455962449,2463680592,2470996774,2478031808,2485029913,2492306073,2499748168,2507243708,2514802151,2522340087,2529893524,2537422956,2544985039,2552418952,2559997611,2567551454,2575041326,2582565183,2590080634,2597483825,2604939881,2612418709,2619764948,2626954883,2633860181,2640730416,2647559062,2654349661,2661197321,2668029044,2674870783,2681822837,2688751220,2695980700,2703058121,2710308333,2717610481,2724871749,2732096260,2739375068,2746633437,2753915752,2761166578,2768405121,2775715315,2782936270,2790085239,2797315849,2804414359,2811406176,2818602711,2825761807,2832910082,2840055501,2847159771,2854362355,2861547560,2868626717,2875748496,2882863603,2889917392,2897041931,2904149614,2911241435,2918246569,2925085240,2931954178,2938767424,2945698745,2952617584,2959604889,2966562364,2973567539,2980631160,2987690501,2994772277,3001792784,3008823383,3015829583,3022890013,3029917107,3036908724,3043891959,3050907044,3057944941,3064695944,3071508332,3078517616,3085446559,3092331991,3099268457,3106310190,3113252673,3120206648,3127128605,3134103301,3141032026,3147918692,3154850158,3161808297,3168668280,3175597745,3182562785,3189489468,3196343438,3203173473,3210048891,3216895747,3223723915,3230582421,3237460330,3244304434,3251144654,3258053799,3264809682,3271656229,3278495562,3285423713,3292231690,3299001477,3305874099,3312678014,3319462408,3326196988,3333097376,3339918944,3346637242,3353387050,3360195665,3366950668,3373725493,3380574494,3387299774,3393641527,3399870281,3406197629,3412465651,3418773260,3425150988,3431455891,3437847409,3444358763,3450951258,3457613525,3464291954,3471059071,3477732189,3484471613,3491270692,3497894184,3504635400,3511364031,3518134489,3524872197,3531593720,3538350666,3545213664,3551939567,3558653691,3565383004,3572155476,3578886492,3585648117,3592468877,3599186954,3605879864,3612482566,3619215894,3625948745,3632595267,3639284900,3646078436,3652761975,3659426831,3666104102,3672841957,3679530788,3686220915,3692906959,3699649639,3706321774,3712960336,3719637475,3726395924,3732986294,3739604986,3746265996,3752876419,3759515978,3766174769,3772919999,3779593075,3786271045,3792969224,3799704099,3806397577,3813042988,3819727847,3826453494,3833078862,3839710389,3846364640,3853081734,3859760741,3866438619,3873005449,3879100662,3885161438,3891470541,3897977101,3904537560,3911116650,3917847215,3924485546,3931045294,3937734812,3944409838,3950998264,3957628495,3964279669,3970877039,3977449384,3984105527,3990829598,3997452906,4004060967,4010658770,4017195497,4023702912,4029166139,4032336872,4035596858,4038887822,4042164062,4045442400,4048738161,4052046047,4055341027,4058632103,4061930167,4065239392,4068542223,4071660894,4074787730,4077939171,4081080153,4084182218,4087327894,4090456446,4093561023,4096687501,4099896762,4103168219,4106383156,4109646244,4112946716,4116239153,4119543335,4122813365,4126090590,4129383035,4132680882,4136003166,4139301474,4142536037,4145736680,4148939585,4152183207,4155462757,4158728972,4161989577,4165276930,4168568469,4171854079,4175175093,4178466114,4181772575,4185076512,4188366488,4191667398,4194970401,4198250336,4201542791,4204845924,4208136378,4211566238,4214821217,4218097726,4221382677,4224667523,4227954014,4231269345,4234582908,4237881174,4241156415,4244434185,4247702281,4250962986,4254242947,4257522912,4260819943,4264112281,4267404625,4270698212,4273997574,4277245832,4280468525,4283718093,4286982671,4290218070,4293491266,4296744451,4300007654,4303255106,4306500404,4309789186,4313056591,4316312128,4319565157,4322822823,4326103381,4329368810,4332622913,4335881400,4339140523,4342400020,4345609310,4348864612,4352096173,4355339254,4358574513,4361870846,4365124596,4368371875,4371651937,4374919040,4378189620,4381449986,4384725154,4387975813,4391256962,4394478096,4397709990,4400970533,4404229910,4407477664,4410705571,4413930451,4417184204,4420371093,4423593929,4426680233,4429778923,4432869027,4435973386,4439059589,4442182890,4445305574,4448384783,4451466130,4454609678,4457836705,4461073136,4464320777,4467578919,4470805345,4474024210,4477267488,4480507160,4483759638,4487036687,4490298439,4493555501,4496811335,4500077938,4503347868,4506610784,4509889121,4513145937,4516394464,4519636669,4522895667,4526149500,4529415861,4532674839,4535945634,4539164348,4542416595,4545675026,4548920403,4552184901,4555428889,4558707735,4561962560,4565213332,4568455763,4571736994,4574990445,4578246844,4581478973,4584751571,4588024891,4591273496,4594536753,4597783235,4601047927,4604261451,4607497630,4610771234,4613855950,4616918246,4620006623,4623153689,4626373334,4629602777,4632869341,4636127608,4639405182,4642670718,4645913110,4649177107,4652430055,4655690450,4658972555,4662242001,4665503513,4668713876,4671944345,4675196990,4678454154,4683191547,4687032442,4690764057,4694403650,4697946184,4701424282,4704859932,4708227847,4711601220,4714907438,4718201245,4721507720,4724799746,4728080160,4731350598,4734628910,4737864031,4741098702,4744323612,4747515327,4750737985,4753982902,4757258182,4760488266,4763739607,4767003354,4770270106,4773530105,4776792092,4780047641,4783132563,4786210479,4789284340,4792379118,4795470046,4798561434,4801646184,4804733710,4807812457,4810973306,4814211941,4817382036,4820633464,4823887525,4827132718,4830391825,4833660748,4836915407,4840159698,4843392743,4846648088,4849911035,4853164859,4856411322,4859673073,4863144046,4866340865,4869575169,4872803021,4876044967,4879282261,4882521888,4885778663,4889021134,4892278440,4895527466,4898797076,4902043330,4905317730,4908553695,4909949189,4911194646,4912424385,4913640085,4914838876,4916044460,4917228254,4918417100,4919632490,4920816897,4921997852,4923171008,4924342979,4925506543,4926673567,4927837176,4928988646,4930155486,4931309649,4932461712,4933612606,4934774127,4935925463,4937083389,4938231138,4939389448,4940527833,4941672473,4942809596,4943965437,4945117951,4946259447,4947406957,4948559518,4949716063,4950864148,4952012929,4953163826,4954310802,4955457948,4956603715,4957746219,4958895839,4960039002,4961179691,4962518247,4963637991,4964771835,4965908734,4967027854,4968169516,4969314433,4970458833,4971604764,4972924879,4974224054,4975903460,4979684570,4983421736,4987193056,4990998293,4994925638,4998828532,5000877232,5002118531,5003264276,5004341577,5005366865,5006354171,5007335564,5009710209,5012498155,5015263364,5018040895,5020809901,5023594026,5026381467,5029151363,5031934093,5034782592,5037611807,5040429098,5043279599,5046137613,5048989899,5051825687,5062812088};
    SAMPLE_LEN = 834;
    EXCERPT_LEN = 3500000;
    for (int i=0; i<SAMPLE_LEN; i++) {
      scycle[i] = scycle_t[i]; sinstr[i] = sinstr_t[i]; }
  }

  else if (fg_name == "raytrace") {
    uint64 scycle_t[] = {10408476,20885952,31361744,41834568,52259448,62786220,73262740,83736800,94218672,104687692,115163236,125640364,136114348,146592592,157067788,167488940,178016204,188495860,198921716,209442680,219916532,230394884,240868740,251344288,261817884,272299288,282768972,293245492,303728584,314207768,324675624,335147616,345624656,356109052,366580404,377037552,387523456,398009620,408478708,418951312,429376656,439902536,450378608,460853072,471331960,481803576,492278464,502763196,513230720,523708004,534180956,544644100,555132132,565606532,576082080,586560636,597037460,607510676,617988444,628464760,638938912,649424724,659891168,670367844,680840940,691314960,701798744,712265680,722742796,733216104,743692360,754167928,764644068,775120748,785594328,796070360,806544164,817018840,827495804,837972804,848396720,858919808,869392880,879870948,890299404,900827524,911299336,921774020,932250892,942726408,953188428,963676232,974157180,984629596,995106560,1005577692,1016055304,1026531516,1037000956,1047490832,1057959232,1068428684,1078856448,1089382820,1099862368,1110282188,1120809732,1131284712,1141764072,1152242856,1162710520,1173185892,1183663412,1194145132,1204612264,1215088904,1225563876,1236040084,1246514944,1256996272,1267471052,1277886584,1288416664,1298892996,1309315676,1319842776,1330317892,1340742264,1351268068,1361746356,1372164984,1382644664,1393175756,1403646824,1414124436,1424544032,1435072816,1445545192,1455972336,1466500852,1476972572,1487446412,1497923904,1508401404,1518871444,1529348060,1539820064,1550298152,1560773968,1571246400,1581710432,1592198592,1602672152,1613147928,1623624672,1634102372,1644562616,1655050928,1665525144,1676001120,1686432776,1696902072,1707430340,1717903360,1728381368,1738853908,1749329064,1759811356,1770284880,1780761188,1791243744,1801709456,1812187200,1822659200,1833138780,1843611512,1854088292,1864558844,1874992472,1885470652,1895941472,1906467604,1916939104,1927401492,1937889776,1948362356,1958839688,1969317540,1979794040,1990260608,2000743240,2011205596,2021693108,2032166616,2042643160,2053068284,2063622420,2074076140,2084556968,2095027812,2105500600,2115974728,2126451888,2136928812,2147400664,2157871944,2168354344,2178823532,2189304512,2199774956,2210249200,2220725392,2231201892,2241678124,2252151148,2262625632,2273103416,2283586280,2294004296,2304532440,2315005680,2325480292,2335954388,2346433924,2356907396,2367381800,2377857196,2388353828,2398811696,2409283524,2419760468,2430238992,2440712260,2451185296,2461665384,2472137392,2482615528,2493095496,2503566084,2514037928,2524515820,2534991604,2545464764,2555942976,2566418336,2576890728,2587371296,2597843484,2608321384,2618792992,2629267640,2639745144,2650221084,2660694968,2671170356,2681646620,2692125444,2702598872,2713070672,2723549700,2734024340,2744498192,2754972708,2765449852,2775927884,2786407548,2796876408,2807350504,2817829152,2828301900,2838727952,2849251116,2859728548,2870205656,2880680092,2891158804,2901635488,2912060204,2922585224,2933074328,2943535764,2954009220,2964491396,2974967396,2985391516,2995912688,3006387756,3016866752,3027345016,3037816092,3048286640,3058763096,3069189260,3079663392,3090193672,3100654872,3111170336,3121616532,3132092080,3142565060,3152992008,3163516076,3173991620,3184482996,3194944084,3205419220,3215844372,3226370984,3236845312,3247322324,3257797876,3268272252,3278745964,3289227224,3299698772,3310173744,3320648836,3331134644,3341606016,3352076172,3362554576,3373030208,3383506504,3393979340,3404454208,3414927164,3425405140,3435880488,3446305492,3456831176,3467305096,3477783204,3488264736,3498682416,3509207868,3519635044,3530165164,3540635492,3551112192,3561584744,3572060476,3582541296,3593010884,3603487228,3613963832,3624388160,3634863928,3645390140,3655865820,3666340812,3676814604,3687296660,3697768264,3708245132,3718717176,3729195572,3739619612,3750145376,3760619280,3771095616,3781577572,3792048788,3802519632,3812997696,3823474248,3833946304,3844425456,3854897516,3865372824,3875850536,3886328232,3896804632,3907278544,3917754276,3928237628,3938704772,3949178880,3959655340,3970128692,3980607816,3991079956,4001508760,4011986300,4022460040,4032986272,4043459524,4053937644,4064414492,4074887260,4085363812,4095837304,4106312088,4116788968,4127261856,4137737276,4148198472,4158716196,4169165640,4179646544,4190113644,4200592356,4211063712,4221489084,4232012576,4242516136,4253044792,4263522676,4273996116,4284482984,4294946172,4305421200,4315897472,4326376384,4336846348,4347327828,4357800564,4368226476,4378755724,4389240040,4399701572,4410126372,4420652612,4431133532,4441591384,4452086376,4462559608,4473039476,4483524836,4493986764,4504467572,4514929044,4525404660,4535865016,4546362776,4556833200,4567311372,4577800132,4588258472,4598687016,4609231140,4619634740,4630161224,4640636536,4651111524,4661589824,4672062528,4682547320,4693011580,4703491892,4713965288,4724439220,4734927340,4745399996,4755864172,4766292756,4776828136,4787294464,4797774568,4808250436,4818726080,4829205124,4839681036,4850158456,4860631488,4871098592,4881578368,4892046920,4902522412,4912997192,4923474216,4933953028,4944425752,4954897216,4965378080,4975863568,4986328284,4996800256,5007278300,5017753216,5028228780,5038705596,5049183356,5059657436,5070132188,5080611296,5091082160,5101559848,5112032820,5122510576,5132979796,5143410476,5153937940,5164412292,5174842400,5185364696,5195733404,5206321824,5216790916,5227264972,5237745224,5248213960,5258691712,5269172956,5279637368,5290116208,5300604388,5311069720,5321542036,5332019748,5342495880,5352972208,5363449096,5373926960,5384393264,5394875200,5405347984,5415830684,5426306576,5436772388,5447243308,5457727960,5468213896,5478671908,5489152956,5499631124,5510047112,5520578360,5531052724,5541528568,5552000364,5562424524,5572961360,5583429112,5593905924,5604331812,5614824704,5625334148,5635808872,5646290740,5656757168,5667246540,5677710916,5688183396,5698661304,5709141384,5719631188,5730090284,5740558880,5751044220,5761519744,5772003872,5782463820,5792936360,5803413936,5813887696,5824361140,5834836864,5845314108,5855788184,5866236208,5876740764,5887221272,5897695060,5908166440,5918644468,5929115816,5939596464,5950069548,5960552732,5971031024,5981502632,5991969588,6002452888,6012923264,6023399212,6033871072,6044350112,6054825772,6065311680,6075780340,6086251816,6096728364,6107215732,6117680408,6128152576,6138579504,6149056852,6159546572,6170060212,6180531140,6191009204,6201479256,6211958056,6222433324,6232919656,6243316916,6253870676,6264344544,6274817192,6285308256,6295761564,6306244700,6316723392,6327190184,6337675544,6348088976,6358623404,6369100184,6379565404,6389990904,6400516148,6410988080,6421466020,6431941076,6442419720,6452890168,6463323104,6473844456,6484318652,6494790724,6505275388,6515696252,6526221312,6536700416,6547178032,6557648232,6568130144,6578598796,6589074600,6599546184,6609972428,6620505892,6630976644,6641449080,6651922480,6662414580,6672878492,6683353952,6693828404,6704308660,6714777892,6725254168,6735731676,6746203912,6756683336,6767167308,6777634832,6788107692,6798586344,6809061716,6819534900,6830005844,6840484864,6850958056,6861450620,6871911884,6882372828,6892865856,6903336544,6913774576,6924289988,6934765144,6945187596,6955711952,6966150908,6976668688,6987142172,6997618012,7008091776,7018572060,7029047760,7039518364,7049998280,7060432696,7070944992,7081420116,7091894556,7102371300,7112847832,7123283608,7133758688,7144286308,7154748944,7165256860,7175706452,7186130464,7196607584,7207128420,7217601084,7228075300,7238553532,7249032584,7259510592,7269978512,7280455440,7290825648,7301329404,7311799888,7322275432,7332831852,7343306988,7353779872,7364217948,7374733564,7385209488,7395691672,7406168064,7416636420,7427108636,7437537056,7448061600,7458547304,7468964740,7479490604,7489969512,7500447860,7510915368,7521400808,7531866048,7542347332,7552819568,7563296896,7573768152,7584243060,7594725104,7605192892,7615669816,7626106976,7636622872,7647096196,7657579596,7668006780,7678472980,7688993456,7699470112,7709945488,7720427120,7730897436,7741372912,7751846996,7762328652,7772750448,7783274376,7793750484,7804228416,7814703580,7825128912,7835653736,7846132348,7856610524,7867082252,7877557444,7888031512,7898503672,7908985028,7919462244,7929945796,7940421364,7950845432,7961358000,7971831972,7982258776,7992786164,8003259588,8013735388,8024208796,8034699052,8045162576,8055644796,8066126784,8076590828,8087091084,8097548996,8108029084,8118498360,8128933212,8139455988,8149878872,8160402040,8170873856,8181354872,8191836584,8202306728,8212775520,8223199732,8233733100,8244207092,8254685908,8265107940,8275581500,8286055100,8296579044,8307057696,8317531536,8328007316,8338448812,8348961424,8359437012,8369913076,8380402756,8390857872,8401281516,8411820532,8422293444,8432765960,8443242128,8453730412,8464188564,8474665680,8485082500,8495612088,8506080408,8516561908,8527037280,8537517776,8547995684,8558462252,8568937568,8579410052,8589888860,8600365784,8610840716,8621319988,8631757540,8642266220,8652761136,8663221244,8673688728,8684118200,8694640500,8705123384,8715588872,8726068736,8736545392,8747031484,8757517316,8767972424,8778450200,8788920184,8799395876,8809872204,8820352244,8830821660,8841259492,8851784368,8862250992,8872726508,8883204364,8893678832,8904155140,8914628576,8925103724,8935575964,8946067880,8956532900,8967044848,8977488868,8987962592,8998435516,9008924748,9019384000,9029862228,9040331076,9050822520,9061286960,9071766232,9082232236,9092709148,9103184736,9113663844,9124135580,9134610436,9145097512,9155563932,9166038080,9176515720,9186995924,9197470960,9207889084,9218420908,9228889644,9239366252,9249850288,9260313268,9270741796,9281263120,9291748188,9302232220,9312713932,9323175848,9333651516,9344130196,9354596912,9365073060,9375553960,9385985028,9396446644,9406970308,9417456580,9427923880,9438402512,9448879952,9459350100,9469822476,9480298840,9490776804,9501248744,9511726944,9522203832,9532679252,9543110436,9553631020,9564107380,9574584796,9585055384,9595532024,9606008184,9616479164,9626965676,9637439640,9647922132,9658387224,9668857896,9679335400,9689810436,9700286772,9710762436,9721238692,9731717228,9742198036,9752666116,9763141748,9773617728,9784103976,9794567212,9805052032,9815516304,9825939336,9836472692,9846957192,9857425024,9867912172,9878370868,9888850212,9899330488,9909793284,9920278920,9930753548,9941235228,9951699128,9962189868,9972650708,9983120920,9993598468,10004071832,10014552008,10025025100,10035504108,10045982012,10056460848,10066933876,10077407756,10087890572,10098357564,10108835644,10119258596,10129786708,10140268288,10150730480,10161208340,10171682564,10182160760,10192637000,10203060008,10213593368,10224062320,10234540520,10245016156,10255484024,10265971204,10276433900,10286916652,10297334824,10307866504,10318340852,10328815224,10339304412,10349770340,10360243872,10370705240,10381196964,10391631568,10402094232,10412570280,10423095228,10433546076,10443941792,10454518536,10464993728,10475467320,10485946352,10496420844,10506901132,10517374004,10527850772,10538327912,10548804076,10559275836,10569699264,10580224004,10590701352,10601178852,10611648052,10622122516,10632610832,10643073692,10653556440,10664030748,10674502744,10684983024,10695460712,10705933236,10716416300,10726883048,10737365656,10747840552,10758308020,10768788592,10779267024,10789740492,10800214288,10810691748,10821159016,10831652464,10842113904,10852583528,10863064348,10873538424,10884019544,10894492440,10904964056,10915445752,10925921412,10936407488,10946866252,10957351328,10967818820,10978294012,10988772576,10999245796,11009723952,11020198800,11030678504,11041143596,11051623916,11062101880,11072572344,11083050296,11093529328,11104000360,11114476492,11124947708,11135432384,11145899192,11156381320,11166851404,11177324032,11187805892,11198284748,11208752796,11219230076,11229710240,11240181700,11250606356,11261130972,11271609504,11282083028,11292556428,11303031608,11313510340,11323982260,11334467108,11344934300,11355410288,11365881892,11376357364,11386841480,11397316052,11407790144,11418260516,11428747932,11439213692,11449690588,11460167424,11470586288,11481076116,11491512048,11501986456,11512459764,11522939576,11533423116,11543891968,11554363296,11564845696,11575313388,11585792476,11596264776,11606742724,11617219004,11627694276,11638169824,11648640732,11659121208,11669597332,11680067420,11690545972,11701019832,11711497716,11721975936,11732453024,11742933568,11753399612,11763872608,11774350748,11784823452,11795298560,11805779088,11816251864,11826731420,11837201344,11847677024,11858150128,11868629436,11879101292,11889578044,11900055824,11910528544,11921005412,11931484552,11941953908,11952429496,11962909640,11973381696,11983861860,11994343064,12004812892,12015282596,12025772980,12036239036,12046664560,12057194564,12067664064,12078140400,12088614844,12099093916,12109564976,12120037828,12130518100,12140987404,12151465220,12161941052,12172417592,12182889676,12193364020,12203841804,12214315664,12224792580,12235267148,12245742656,12256218304,12266692868,12277170548,12287649892,12298118916,12308597116,12319072648,12329554764,12340024184,12350498448,12360972352,12371449644,12381925984,12392400740,12402874184,12413351588,12423828868,12434299572,12444777548,12455255868,12465726844,12476192976,12486677744,12497156324,12507628036,12518063972,12528539096,12539016908,12549534900,12560005656,12570570820,12581041780,12591515456,12601987944,12612469624,12622947848,12633418604,12643892132,12654368032,12664842736,12675318548,12685791776,12696271112,12706744696,12717220012,12727702620,12738166264,12748647968,12759123188,12769596508,12780070988,12790546368,12801021344,12811500448,12821984512,12832448476,12842921548,12853400736,12863881308,12874351000,12884827676,12895308524,12905781704,12916252312,12926729056,12937200332,12947678316,12958155228,12968631524,12979102996,12989580280,13000059336,13010530092,13021016124,13031481276,13041959544,13052435696,13062905408,13073381468,13083858772,13094338056,13104816272,13115288852,13125766312};
    uint64 sinstr_t[] = {24973402,37160084,46389555,55875425,65452119,75048457,84919986,94834037,104425188,113806532,123707186,133606416,143648801,154040161,163884651,174357977,184652631,194791266,204900752,215035826,225654070,235828620,245924544,256062192,266599839,276918010,287894336,298417449,308591100,319095365,330125478,340851922,351505515,361497645,372335142,383113716,393585357,404575327,414271536,425304155,436030737,446797232,457900031,468297870,479502660,490790542,501627891,512389020,523697807,534924331,546498921,557070090,568985906,580690322,591226104,602511899,614258826,625249611,636672996,648066368,658761623,669623387,680306784,691184091,702126688,713682790,724265453,736001300,746790099,759195156,770213003,782491256,794567694,805848809,819056679,830319444,842882542,857232351,865278429,875833134,884474360,899585978,912341004,924474863,935522155,948231190,960143244,971426779,984264047,993665542,1004345679,1013938037,1024021045,1036091855,1057810393,1067708663,1076733502,1087575398,1103214373,1111988334,1120076348,1126824215,1136397470,1144967325,1154732386,1165318326,1174170639,1182976888,1191518591,1201458242,1210415360,1222030283,1234355380,1243861694,1254057367,1266617266,1275989218,1285044224,1296025560,1306440558,1314101440,1323811494,1332666415,1343506747,1355463004,1365988863,1375011375,1389083219,1398025421,1407759275,1422287372,1430471857,1438789867,1448046339,1457112242,1466278635,1475565288,1484848865,1494013016,1503403500,1512780930,1522197872,1530320735,1538900577,1559976687,1584537597,1608666294,1633338981,1658016451,1682230225,1706841725,1731581447,1756202756,1780873462,1805536169,1829324345,1853950167,1878748264,1903470896,1928126807,1952744658,1977493512,2002304599,2026973077,2051648931,2075146225,2099105706,2123624749,2147651939,2171788188,2195844847,2219872630,2243914301,2267903883,2291982218,2316403445,2340851111,2365545195,2390105555,2414481701,2438881133,2463473733,2488035070,2512665232,2537377477,2562084063,2586685686,2608202990,2630742318,2655367597,2680035894,2704698582,2729437563,2754176623,2778964193,2803379603,2828235245,2852952702,2877754343,2902457605,2927227804,2952074968,2976835004,3001539316,3026246493,3050954134,3075696662,3100474159,3125263795,3150011506,3174842729,3199649394,3224374766,3249210482,3274035448,3298781274,3323589347,3348445900,3373067856,3397943327,3422712616,3447504910,3472248310,3495550802,3520305096,3545083246,3569824960,3594590775,3619149220,3643829541,3668550306,3685379079,3709937980,3734640637,3758572769,3782205556,3805716466,3829328314,3852957604,3876592487,3900063983,3924002416,3948684835,3973347826,3997994962,4022672428,4047341647,4071931047,4096564856,4121232690,4145862436,4170578722,4195258469,4219854791,4244571024,4269335734,4293978696,4318686455,4343409249,4368032103,4392718429,4417444117,4442132922,4466823143,4491440907,4515443662,4538913360,4563617717,4588251060,4612892448,4637429185,4662153534,4686804821,4711556864,4736294317,4761106979,4785650844,4809670623,4834008051,4858220935,4882390207,4906573815,4930808887,4955024415,4979511930,5004164707,5028861179,5053567451,5078206225,5102922872,5127598237,5152328272,5176916386,5201648715,5226532638,5251071939,5275788048,5300466306,5325194923,5349934260,5374543669,5399369025,5424093777,5448899926,5473675202,5498478877,5523190515,5548162728,5572961517,5597776826,5622646642,5647463703,5672305306,5697158657,5721987872,5746798957,5771498262,5786443347,5809313755,5834212355,5859195316,5884168195,5909086949,5933941943,5954865794,5973782089,5992650044,6011266805,6030139680,6048989131,6067665210,6086700446,6105919375,6124796156,6143573360,6161928678,6180511790,6199815040,6218947844,6237904014,6256929303,6276114409,6295034624,6313818354,6332554115,6351215083,6369572570,6387371426,6404857767,6423839322,6442774095,6461508372,6480084848,6498789049,6517509992,6536402147,6555135558,6574141915,6592877469,6611532083,6630070166,6648521769,6666933108,6685392548,6703818261,6722435311,6740959294,6759261810,6777941759,6796371408,6814925505,6833430817,6849481439,6867654039,6883530699,6901726955,6920161046,6938685866,6957299083,6975858244,6994740223,7013232012,7031857492,7050242691,7068561477,7086757042,7104443986,7122516147,7140589335,7158320000,7176264151,7194073110,7212002019,7229993789,7248065477,7266352762,7284439462,7302492705,7320233060,7338014476,7356230687,7374354485,7392539732,7410822327,7429217738,7447398085,7465616922,7483789552,7501956984,7519914669,7538069601,7556233042,7574409004,7592817953,7611003428,7629198506,7647213856,7665559880,7683790929,7702180092,7720419660,7738453258,7756481738,7773047858,7786144481,7803804732,7821585508,7834526741,7852623364,7870814039,7888592470,7907103072,7925254440,7943312529,7961460955,7979647356,7997917611,8016141157,8034198149,8052641086,8070821192,8089172901,8107740251,8125647910,8144213060,8162443464,8180474907,8198670356,8216715131,8234977011,8252882836,8270708166,8288761342,8306939604,8325026134,8343162695,8361288374,8379200314,8397500156,8415437741,8433667309,8451688444,8469821163,8487841688,8505576767,8523291137,8540301090,8557895189,8575350368,8593452354,8611156220,8628475839,8645875643,8663615953,8681238811,8698629812,8715590617,8733361955,8750579059,8767932981,8784652936,8801719536,8818541439,8835955027,8853066399,8870803741,8888301816,8905846737,8923108028,8939923769,8956261150,8972811062,8988519923,9004850171,9021892030,9038219769,9054735634,9070424359,9087038969,9103148846,9119285500,9135035503,9151326196,9167620053,9184726714,9202449267,9219666119,9236693441,9253715183,9271129390,9288429760,9306274000,9324068880,9342132931,9359833854,9378030995,9395864049,9414158988,9432116067,9449953616,9467994856,9486253951,9503997531,9522130270,9540039137,9558359398,9576529291,9594770424,9612914344,9631331800,9649402767,9667891920,9685825051,9704051935,9722086395,9735724140,9748838717,9766740125,9775736071,9793805264,9811930952,9830094226,9848702877,9866825023,9884922809,9902938880,9920654966,9938969022,9957087783,9975433237,9993798857,10011789118,10030091750,10048205125,10066615710,10084942577,10103389418,10121796469,10139810961,10158139141,10176076840,10193689483,10211221121,10228964827,10247156437,10265727900,10284060634,10302507601,10320829525,10337462057,10355385868,10373976925,10392350467,10410928637,10429345840,10447999112,10466458940,10485192650,10503482824,10522232025,10540658906,10559223375,10577602914,10595957451,10614516353,10632681561,10650696171,10669001904,10687073440,10705735876,10724059687,10742497542,10760842802,10779289337,10797785025,10816151422,10834645920,10853477373,10872200370,10891034151,10909699282,10928612929,10947236756,10965524043,10983660879,11001967556,11020032150,11037169115,11055169744,11073115197,11091557981,11109905807,11128814095,11147434579,11166464686,11185000645,11203878291,11222710702,11241608724,11260295971,11279052524,11297932418,11316785095,11334771279,11353252501,11372144969,11390757043,11409714417,11428288295,11447125282,11465413313,11483885862,11501846528,11519438384,11536790791,11554756070,11573310180,11591551401,11610026953,11628147648,11644830239,11663200660,11681252394,11699731973,11718044789,11736469221,11754802068,11773014205,11791178442,11809535541,11827695234,11845849921,11863982121,11882496549,11900808512,11919141907,11937250381,11955563727,11973770764,11991826780,12010009751,12028278495,12046055977,12064262911,12081953374,12100185559,12117996664,12135626083,12153104766,12170824118,12188724049,12206511887,12224535544,12242350221,12260797875,12278855164,12296964563,12315001585,12333273232,12351302049,12369518953,12387955821,12406182299,12424450926,12442315605,12460074161,12477981992,12495859704,12513852804,12531334010,12549406501,12567187600,12584713682,12602070182,12619536301,12637175360,12654926787,12672832457,12690830197,12708895334,12726923344,12744162174,12761089651,12777920303,12794486079,12812310617,12830177919,12848359843,12866339747,12884268576,12902259107,12920353429,12938040582,12955739676,12973275695,12990787376,13008155936,13025738100,13043437171,13061287780,13079298251,13097416566,13115482623,13133489846,13151843157,13170237613,13188510968,13206792052,13225218141,13243641556,13262023650,13280089234,13298325950,13316468646,13334543553,13352069830,13369761744,13387212449,13404772867,13422260276,13439881481,13457666269,13474454841,13492073969,13510033945,13527599585,13544305382,13561624439,13579756694,13598106043,13616411003,13634655546,13652982009,13671609556,13687830293,13695011256,13706699000,13713407403,13727903415,13746579848,13765046128,13782724299,13800882951,13819313353,13838091368,13856885709,13875730516,13894626411,13913625423,13932652169,13951665248,13970825237,13989880125,14005639896,14007452369,14017454292,14029591104,14041475041,14052529999,14064285435,14075707208,14084920545,14094608397,14112071258,14140085235,14168268558,14196378326,14224545646,14252560678,14270889384,14289898129,14309333442,14329738491,14351406139,14374747508,14397921593,14421354882,14444765535,14468142350,14491437642,14514757946,14543207498,14577867247,14607889088,14635682911,14663544705,14695005522,14723179115,14752541653,14778369901,14802053578,14822127754,14842885093,14863204834,14884653924,14904977757,14925554038,14946422569,14966679026,14988758067,15008870080,15028934308,15048845306,15066628447,15086077019,15106393866,15128659402,15150275364,15170889896,15191297407,15212203848,15232614139,15253335071,15275122125,15295613468,15316346749,15337212929,15357600795,15378429479,15396878262,15421628815,15446302664,15468508436,15488838097,15509510479,15529932400,15550580594,15571131485,15591694132,15612297384,15634171872,15654627507,15675329448,15696115806,15717606176,15738271490,15757119272,15777986981,15801844845,15822247652,15844261188,15864627809,15885528059,15906634241,15927108105,15949012081,15970027327,15990325351,16011197335,16031703465,16052210960,16073072728,16093378410,16112357607,16132946089,16153266115,16179264288,16206359226,16231018349,16255436620,16278196735,16298563475,16319259450,16339626254,16361304831,16381742215,16402512893,16423048443,16445208140,16466471076,16486728563,16507749084,16527975077,16546523011,16567146339,16587247523,16608003740,16628759524,16651499092,16675487015,16696073997,16716984191,16738348851,16758868310,16779407117,16801717561,16822102718,16842927484,16864027985,16882293087,16902501382,16923899244,16944913565,16965342042,16986665373,17007089520,17027915547,17048480088,17070965124,17095036142,17119708471,17141796847,17162267806,17182996962,17203260705,17224310879,17244535052,17263125518,17285136510,17305421089,17325632540,17346298440,17366555587,17388043504,17409223065,17429574174,17450266342,17470538157,17491882178,17513357663,17533922849,17554997599,17575423861,17594232992,17617420698,17637994331,17658261896,17678537313,17699804705,17720539492,17743587500,17763809705,17784318152,17805349649,17826025778,17846469462,17867722049,17888746221,17911012448,17938824386,17966675432,17995905440,18028167898,18055810521,18080491704,18104885140,18129890896,18153115234,18171566973,18192836756,18214113809,18234462987,18255238936,18275670716,18297440595,18318112968,18339567152,18359951484,18380649879,18402929430,18423711893,18444551077,18465826147,18485867659,18505686589,18526436978,18547520146,18571924550,18592011410,18612420814,18632716090,18653502295,18673633971,18693802490,18714239741,18734907583,18756230769,18776901136,18797211760,18818434818,18836908938,18857796643,18878386610,18902510835,18926811185,18947134645,18967714930,18988706786,19010770980,19033636455,19054438189,19074992238,19096154994,19116979853,19139039427,19159453701,19180702035,19199248506,19219996135,19241954489,19264562192,19284721837,19306059873,19325220530,19345986305,19366429591,19387738222,19408530345,19429416481,19449838954,19473787909,19494105974,19514533357,19535010222,19553773277,19574262424,19594979887,19615392209,19637374448,19657963215,19678262630,19698657348,19721870506,19749627796,19779833076,19805480419,19829790107,19851101574,19871861423,19892178025,19912747194,19933019558,19953735828,19974941871,19993625292,20014617569,20035155480,20055807828,20078335552,20098995941,20119983256,20141453085,20162772459,20183629453,20204715364,20225504507,20246078632,20270290879,20290772819,20311609321,20332223833,20351768706,20372862006,20393189249,20413989072,20436948967,20457202350,20477836610,20498655564,20519492493,20540020527,20561328981,20581743204,20602317209,20622933966,20643598023,20663299356,20692026599,20715297062,20735782878,20756067521,20776656571,20798472245,20820203448,20840575762,20861343655,20881668121,20902799653,20923136976,20944310852,20964543977,20985103577,21007002324,21032763519,21051136031,21071825527,21092517668,21112175001,21133224824,21153508450,21173930558,21194204839,21215959735,21238331103,21259020380,21279429558,21299800726,21320136155,21342058080,21362698752,21381113740,21401931548,21422239194,21442784346,21462862805,21480289160,21504406135,21529666291,21553992810,21578441113,21602972083,21628408881,21653775918,21678921949,21704559552,21729104096,21754653907,21780282057,21804625484,21829371381,21854740343,21880257088,21904686319,21930522162,21954825710,21980029135,22003971766,22028497209,22053192603,22076441955,22101496743,22125456804,22149979437,22174531886,22198539819,22222491858,22246829994,22271472263,22295874783,22321154624,22346547888,22371678316,22396802343,22422367056,22447684704,22471999023,22497778140,22516064888,22539129802,22564716110,22589296127,22613777178,22639225325,22664032920,22689941305,22715007741,22740604507,22766117622,22790956277,22816732610,22842203470,22866913834,22891820389,22917421607,22942236182,22968654486,22992856496,23017896391,23042918007,23067109251,23092166291,23116383499,23141288115,23166576428,23190421245,23215000887,23239653638,23263277554,23287753027,23312860373,23337451248,23362488968,23388095570,23413980825,23438875145,23464270261,23489812332,23515196189,23540634168,23559596724,23581871931,23607267903,23631865843,23656385092,23681797018,23706766215,23732555716,23757807349,23782942221,23808512975,23833451781,23858886653,23884316931,23909265767,23932421964,23957434083,23982557954,24008420363,24033299711,24057951914,24082987807,24107406992,24132175192,24157232322,24181360736,24206715344,24231179172,24255775052,24280935946,24305138940,24329288908,24354207118,24379425519,24403933264,24429220591,24455091702,24480937996,24505488647,24531085333,24556630564,24582450421,24599284920,24608303245};
    SAMPLE_LEN = 1253;
    EXCERPT_LEN = 11000000;
    for (int i=0; i<SAMPLE_LEN; i++) {
      scycle[i] = scycle_t[i]; sinstr[i] = sinstr_t[i]; }
  }

  else if (fg_name == "streamcluster") {
    uint64 scycle_t[] = {10475316,20934248,31409972,41884628,52378540,62837084,73309892,83787156,94286096,104736600,115212768,125688564,136161420,146641640,157114364,167590800,178085008,188539080,199028800,209494964,219964876,230444672,240915804,251392888,261886828,272297572,282825216,293297248,303791204,314244332,324722656,335198732,345690644,356145840,366624984,377101208,387599988,398076644,408529528,419012212,429492312,439965416,450441480,460911388,471401836,481865488,492290856,502822332,513281260,523756396,534236524,544705400,555200444,565655116,576130932,586608368,597045820,607560940,618037440,628509452,638986332,649458672,659940524,670411732,680889252,691362568,701846100,712317640,722808800,733272260,743741084,754222016,764711596,775115380,785590836,796013628,806542956,817015196,827493472,837971056,848444156,858921328,869393964,879873596,890346180,900831056,911295952,921824664,932296260,942777124,953253680,963724660,974225076,984672508,995156264,1005611676,1016087440,1026581460,1037051296,1047528520,1058024240,1068481104,1078962036,1089433768,1099936372,1110386660,1120858036,1131335016,1141831372,1152282292,1162764340,1173240348,1183730348,1194200096,1204662632,1215144380,1225613084,1236089324,1246564992,1257039896,1267536580,1277989084,1288480808,1298948176,1309445584,1319900588,1330375975,1340853251,1351336915,1361803687,1372279499,1382749359,1393256819,1403704279,1414174487,1424598031,1435120331,1445597727,1456075851,1466546455,1477040195,1487496287,1497978227,1508458059,1518925487,1529398783,1539878659,1550350975,1560826931,1571304031,1581782399,1592267491,1602685079,1613206535,1623684131,1634158807,1644647635,1655109711,1665591135,1676055459,1686564767,1696957063,1707486511,1717908651,1728457623,1738907863,1749382983,1759872023,1770353823,1780814767,1791300547,1801764891,1812254279,1822714595,1833195011,1843614099,1854140579,1864612991,1875096599,1885572707,1896042623,1906520487,1916992235,1927470451,1937958363,1948365907,1958896735,1969370043,1979842623,1990330527,2000795995,2011276139,2021747883,2032222783,2042698279,2053107599,2063650003,2074074947,2084564883,2095031355,2105549743,2116031171,2126511611,2136982375,2147469735,2157932855,2168404383,2178881275,2189380991,2199837323,2210318387,2220780903,2231254791,2241739159,2252208971,2262685687,2273158955,2283650639,2294113551,2304586539,2315074711,2325487979,2336019459,2346493599,2356983887,2367392631,2377919607,2388419999,2398882815,2409341659,2419818207,2430289015,2440780939,2451245171,2461666243,2472192387,2482667423,2493155567,2503616375,2514095483,2524582399,2535045811,2545521027,2556000835,2566468055,2576948131,2587434271,2597897855,2608371319,2618847735,2629331251,2639799295,2650291835,2660754019,2671228739,2681704827,2692198779,2702649935,2713128911,2723592095,2734092631,2744550999,2755031603,2765508991,2775996535,2786473363,2796930175,2807405651,2817879843,2828364143,2838832603,2849312767,2859803779,2870256543,2880734279,2891172487,2901684347,2912159555,2922637731,2933109675,2943600923,2954063035,2964539567,2974964403,2985515943,2995964115,3006440183,3016918215,3027379331,3037869431,3048345011,3058825907,3069292467,3079771075,3090202295,3100666739,3111211451,3121672199,3132156499,3142632315,3153113859,3163579971,3174058995,3184531871,3195020231,3205429523,3215955575,3226429203,3236901063,3247376351,3257851699,3268329983,3278821987,3289288403,3299751411,3310226647,3320651695,3331181755,3341655995,3352133403,3362604631,3373086471,3383566819,3394032779,3404506923,3414984115,3425463123,3435936727,3446426939,3456873491,3467364839,3477851399,3488340379,3498795051,3509273703,3519742975,3530233099,3540691479,3551163207,3561592659,3572116539,3582546327,3593069691,3603542651,3614033003,3624496871,3634968675,3645447915,3655939071,3666395587,3676870335,3687354879,3697845307,3708295763,3718770839,3729246655,3739722639,3750197879,3760673339,3771149551,3781644735,3792101583,3802575171,3813048787,3823546339,3834001691,3844479815,3854951159,3865426767,3875855723,3886385075,3896860319,3907345447,3917809235,3928281431,3938754603,3949232807,3959706079,3970184643,3980668015,3991133479,4001616707,4012091843,4022562559,4033061043,4043512279,4053987915,4064464383,4074959399,4085431047,4095889159,4106371151,4116840083,4127317667,4137793723,4148160691,4158617695,4169088867,4179570643,4190121199,4200595583,4211067691,4221551863,4232020819,4242560323,4253022567,4263498527,4273927571,4284466303,4294926519,4305397311,4315876483,4326347655,4336828899,4347306779,4357774003,4368198691,4378734179,4389205775,4399682499,4410151519,4420631163,4431104647,4441581551,4452069243,4462529951,4473008519,4483490123,4493970631,4504430051,4514909367,4525387695,4535878087,4546331979,4556807051,4567280595,4577786391,4588235595,4598712635,4609190111,4619681811,4630142711,4640614871,4651089691,4661580387,4672039679,4682521539};
    uint64 sinstr_t[] = {24645220,36276874,44757074,53994502,62982169,72167694,81886838,90928413,100386732,109649634,119223679,128864805,138838653,149212152,159623478,169972049,180347482,190201075,200549697,210835135,221080621,231704173,242352657,252988961,263369395,273230781,283908716,294716340,305287067,315749962,327214415,337775442,347946449,358745490,369609435,380399936,391060346,401881573,411933572,422731142,433428266,444663874,455836553,466066042,477265655,488626457,499474248,510525998,521314138,533022905,544555666,555220265,566836534,578684886,590107762,601141217,612188815,624336437,635619010,646762271,658951160,669979702,681339048,692700400,704588458,715830823,727450570,739685558,751221406,763105921,774651201,786545698,799316242,810791606,823322912,835183484,848321881,860811181,869017671,878237953,888402521,904586401,918373975,928010333,939849202,951569299,963444764,975225167,987332998,997043977,1007168445,1017329736,1027052473,1039010256,1060723299,1070718925,1085159070,1097989384,1106130914,1115007273,1123434304,1131259107,1140492287,1149023152,1159645126,1169475561,1178939711,1187884304,1197844881,1207642758,1215487058,1228295309,1238295396,1246950892,1257333812,1269214587,1278177429,1287140672,1297081000,1306900863,1315168991,1324760661,1333812230,1344484603,1357153523,1367234084,1376754130,1390261085,1399235366,1408020670,1416092702,1424133927,1445037075,1466125963,1480528191,1494464012,1508428800,1522446268,1536170865,1550162510,1564262339,1578092181,1591938446,1606076708,1620276475,1634137627,1648090218,1662049408,1675792464,1689785304,1703860527,1718059340,1732180884,1746277714,1760507255,1774625962,1788795197,1802814436,1816902509,1831078354,1845340845,1859358021,1873573025,1887543480,1901795349,1915635371,1929759822,1943707102,1957834957,1971777534,1985948960,2000077637,2014157432,2028260124,2042405073,2056540330,2070736037,2084819588,2098746958,2112845645,2126962895,2141018177,2155260855,2169211273,2183447678,2197269324,2211476301,2225439582,2239173647,2252029408,2265934476,2279990549,2294126432,2308140128,2322315760,2335981539,2349549778,2362609408,2375200067,2387970803,2401238820,2414943230,2428045099,2442225161,2456146391,2469849232,2483872829,2497904029,2511980727,2526087791,2540140361,2554196019,2568357320,2582270824,2596486931,2610695167,2624871020,2638949258,2653051524,2666581873,2679639464,2692542151,2705660717,2718546856,2731662125,2744330115,2757410495,2770342822,2783011686,2797156317,2810750617,2824836838,2839043892,2853339529,2867678984,2882044150,2896430613,2910784290,2925108900,2939464342,2953745549,2968073786,2982461628,2996844137,3011180126,3025137074,3039348702,3053576458,3067903636,3082155782,3096519545,3110921901,3125302028,3139663839,3153910796,3168363921,3182741668,3196797195,3210611223,3224303207,3238236539,3252447687,3266588045,3280907156,3295379204,3309484513,3323972451,3338263748,3352642760,3367072779,3381516439,3395965420,3410501225,3424854415,3439293120,3453739511,3468280696,3482773925,3497131051,3511597533,3526145765,3540634275,3555102149,3569547266,3584105336,3598248426,3612700872,3627041771,3641340921,3655793078,3670222687,3684651265,3699114497,3713562571,3728014187,3742165241,3756045937,3770376485,3784814501,3799322904,3813805336,3828300170,3842768733,3857284567,3871782129,3885822510,3900309987,3914681161,3929115775,3943458840,3957969286,3972485634,3987019996,4001287014,4015762290,4030321166,4044754360,4059337931,4073762810,4088310333,4102872904,4117404921,4131951045,4146523529,4161112111,4175305189,4189746573,4204119103,4218091984,4231035948,4244126090,4257355743,4270491167,4282515708,4295506901,4308819153,4321874065,4334776014,4348935205,4362553469,4377046420,4391342665,4405822355,4420302364,4434195380,4448302391,4462657769,4476954871,4491037201,4505358389,4519819550,4534374649,4548858074,4563241280,4577797263,4592321099,4606792349,4621197274,4635649272,4650183029,4664727292,4679195659,4693632332,4708146514,4722702179,4736843989,4751336601,4765770407,4780140352,4794569501,4809129687,4823571862,4838149854,4852655468,4867186304,4881741607,4896306085,4910814553,4925249742,4939830914,4954304194,4968763888,4983258320,4997785174,5012329980,5026409466,5040856897,5055256691,5069731172,5084280664,5098799668,5113347716,5127904121,5142424447,5156941113,5171089778,5184952148,5199464913,5213923499,5228566866,5242393146,5255307128,5267211928,5280305718,5294738192,5308786799,5323204469,5337272646,5351652336,5366135777,5380691899,5395154368,5409720910,5424247609,5438774123,5453354188,5467841880,5482503245,5496878963,5511440137,5525870853,5540397423,5554892101,5569480427,5583985499,5598141873,5612640920,5627109097,5641559377,5655964187,5670490096,5685010458,5699503979,5714003262,5728365266,5742882680,5757387682,5771584303,5784462643,5797502516,5810573328,5823707520,5836807016,5850100473,5863429882,5876026804,5884985378};
    SAMPLE_LEN = 447;
    EXCERPT_LEN = 15000000;
    for (int i=0; i<SAMPLE_LEN; i++) {
      scycle[i] = scycle_t[i]; sinstr[i] = sinstr_t[i]; }
  }

  else {
    cerr<<"ERROR: cannot recognize FG job"<<endl;
    exit(0);
  }
#endif

#ifdef PRINT_SAMPLES
  m_timer_ofile_cycle.open(cyc_path.c_str());
  m_timer_ofile_instr.open(ins_path.c_str());
#endif

  /* Initialize PCM */
  m_PCM_handle = PCM::getInstance();

  m_PCM_handle->resetPMU();
  PCM::ErrorCode status = m_PCM_handle->program();
  for (int i=0; i<CORE_NUM; i++)
    m_MSR_handle[i] = new MsrHandle(i);

  if (status != PCM::Success)
    errExit("PCM init");

  /* Initialize PCM for L3 Miss */
  EventSelectRegister event_select_reg1;
  event_select_reg1.fields.event_select = MEM_LOAD_UOPS_LLC_MISS_RETIRED_LOCAL_DRAM_EVTNR;
  event_select_reg1.fields.umask = MEM_LOAD_UOPS_LLC_MISS_RETIRED_LOCAL_DRAM_UMASK;
  event_select_reg1.fields.usr = 1;
  event_select_reg1.fields.os = 1;
  event_select_reg1.fields.edge = 0;
  event_select_reg1.fields.pin_control = 0;
  event_select_reg1.fields.apic_int = 0;
  event_select_reg1.fields.any_thread = 0;
  event_select_reg1.fields.enable = 1;
  event_select_reg1.fields.invert = 0;
  event_select_reg1.fields.cmask = 0;
  event_select_reg1.fields.in_tx = 0;
  event_select_reg1.fields.in_txcp = 0;

  EventSelectRegister event_select_reg2;
  event_select_reg2.fields.event_select = MEM_LOAD_UOPS_LLC_HIT_RETIRED_XSNP_NONE_EVTNR;
  event_select_reg2.fields.umask = MEM_LOAD_UOPS_LLC_HIT_RETIRED_XSNP_NONE_UMASK;
  event_select_reg2.fields.usr = 1;
  event_select_reg2.fields.os = 1;
  event_select_reg2.fields.edge = 0;
  event_select_reg2.fields.pin_control = 0;
  event_select_reg2.fields.apic_int = 0;
  event_select_reg2.fields.any_thread = 0;
  event_select_reg2.fields.enable = 1;
  event_select_reg2.fields.invert = 0;
  event_select_reg2.fields.cmask = 0;
  event_select_reg2.fields.in_tx = 0;
  event_select_reg2.fields.in_txcp = 0;

  for (int i=0; i<CORE_NUM; i++) {
    m_MSR_handle[i]->write(IA32_PCM0, 0);
    m_MSR_handle[i]->write(IA32_PERFEVTSEL0_ADDR, event_select_reg1.value);
    m_MSR_handle[i]->write(IA32_PCM1, 0);
    m_MSR_handle[i]->write(IA32_PERFEVTSEL1_ADDR, event_select_reg2.value);
    excerpt_penalty[i] = new int64 [EXCERPT_NUM];
    for (int j=0; j<EXCERPT_NUM; j++) {
      excerpt_penalty[i][j] = 0;
    }
  }

  last_stat = NULL;
}

void monitor_c::get_stat(stat_c* s)
{
  m_MSR_handle[0]->read(16, & s->tsc);
  s->tp = system_clock::now();
  for (uint i=0; i<CORE_NUM; i++) {
    m_MSR_handle[i]->read(0x309, & s->instr[i]);
    m_MSR_handle[i]->read(IA32_PCM0, & s->l3_miss[i]);
    m_MSR_handle[i]->read(IA32_PCM1, & s->l3_hit[i]);
  }
}

void monitor_c::freq_scale()
{
  // check if all processes behave the same
  bool one_too_slow = false;   // at least one FG is slow and require pause BG
  bool all_fast = true;        // all FGs are faster than expectation
  bool stopped_bg = false;     // at least one BG is stopped
  int  slow_count = 0;         // number of FGs that are slower than expectation
  int  fast_count = 0;         // number of FGs that are faster than expectation
  int  handle_count = 0;       // number of slow FGs that are handled
  for (int i=0; i<process_num; i++) {
    if (process[i]->fg && process[i]->start_tsc != 0) {
      slow_count = process[i]->eta_avg > 1.00*process[i]->eta_target ? slow_count+1 : slow_count;
      fast_count = process[i]->eta_avg < 0.98*process[i]->eta_target ? fast_count+1 : fast_count;
      one_too_slow |= (process[i]->eta_avg > 1.07*process[i]->eta_target);
      all_fast &= (process[i]->eta_avg < 0.98*process[i]->eta_target);
    }
    else if (!process[i]->fg) {
      stopped_bg |= process[i]->stop;
    }
  }

  // handle slow FGs
  if (slow_count!=0 && m_sample_num%10 == 0) {
    // increase FG frequency
    for (int i=0; i<process_num; i++) {
      if (process[i]->fg && process[i]->eta_avg > 1.00*process[i]->eta_target) {
        /*
        int ci = process[i]->core_id;
        if (fg_freq_idx[ci] != MAX_FREQ_IDX) {
          fg_freq_idx[ci] = MAX_FREQ_IDX;
          fprintf(process[i]->cpu_speed_file, "%i", FREQ_ARR[MAX_FREQ_IDX]);
          fflush(process[i]->cpu_speed_file);
          handle_count++;
        */
        int ci = process[i]->core_ids[0];
        // FIXME: changed to support multiple cores
        if (fg_freq_idx[ci] != MAX_FREQ_IDX) {
          for (int j=0; j<process[i]->ci_count; j++){
            int core_id = process[i]->core_ids[j];
            fg_freq_idx[core_id] = MAX_FREQ_IDX;  // Statically Set to the highest core freq.
          }
          //fg_freq_idx[ci] = MAX_FREQ_IDX;  // Statically Set to the highest core freq.
          // FIXME: changed to support multiple cores
          for (int j=0; j<process[i]->ci_count; j++){
            fprintf(process[i]->cpu_speed_files[j], "%i", FREQ_ARR[MAX_FREQ_IDX]);
            fflush(process[i]->cpu_speed_files[j]);
          }
          //fprintf(process[i]->cpu_speed_file, "%i", FREQ_ARR[MAX_FREQ_IDX]);
          //fflush(process[i]->cpu_speed_file);
          handle_count++;
        }
      }
    }
    // decrease BG frequency
    if (handle_count != slow_count && bg_freq_idx > MIN_FREQ_IDX) {
      bg_freq_idx = MIN_FREQ_IDX;
      int freq_num = FREQ_ARR[MIN_FREQ_IDX];
      for (int i=0; i<process_num; i++) {
        if (process[i]->fg)
          continue;
        //fprintf(process[i]->cpu_speed_file, "%i", freq_num);
        //fflush(process[i]->cpu_speed_file);
        // FIXME: changed to support multiple cores
        for (int j=0; j<process[i]->ci_count; j++) {
          fprintf(process[i]->cpu_speed_files[j], "%i", freq_num);
          fflush(process[i]->cpu_speed_files[j]);
        }
      }
    }
    // pause BG
    else if (handle_count != slow_count && one_too_slow) {
      // find the BG process that is generating the most L3 Misses
      float max_l3_miss = 0;
      int max_process_i = -1;
      for (int i=0; i<process_num; i++) {
        if (!process[i]->fg && process[i]->avg_l3_miss >= max_l3_miss
            && process[i]->stop == false) {
          max_l3_miss = process[i]->avg_l3_miss;
          max_process_i = i;
        }
      }
      if (max_process_i != -1) {
        // pause this process
        kill(process[max_process_i]->pid, SIGSTOP);
        process[max_process_i]->stop = true;
      }
    }
  }

  // when all FGs are fast
  if (fast_count != 0 && m_sample_num % 5 == 0) {
    if (all_fast && stopped_bg) {
      // find the BG process that is generating the least L3 misses
      float min_l3_miss = FLT_MAX;
      int min_process_i = -1;
      for (int i = 0; i < process_num; i++) {
        if (!process[i]->fg && process[i]->avg_l3_miss < min_l3_miss
            && process[i]->stop == true) {
          min_l3_miss = process[i]->avg_l3_miss;
          min_process_i = i;
        }
      }
      if (min_process_i != -1) {
        // continue this process
        kill(process[min_process_i]->pid, SIGCONT);
        process[min_process_i]->stop = false;
      }
    } else if (all_fast && bg_freq_idx < MAX_FREQ_IDX - 1) {
      bg_freq_idx += 2;
      int freq_num = FREQ_ARR[bg_freq_idx];
      for (int i = 0; i < process_num; i++) {
        if (process[i]->fg)
          continue;
        // FIXME: changed to support multiple cores
        for (int j = 0; j < process[i]->ci_count; j++) {
          fprintf(process[i]->cpu_speed_files[j], "%i", freq_num);
          fflush(process[i]->cpu_speed_files[j]);
        }
        //fprintf(process[i]->cpu_speed_file, "%i", freq_num);
        //fflush(process[i]->cpu_speed_file);
      }
    } else {
      // when not all fast or
      // when all fast and all other techniques have been tried
      for (int i = 0; i < process_num; i++) {
        if (process[i]->fg && process[i]->eta_avg < 0.98 * process[i]->eta_target) {
          /*int ci = process[i]->core_id;
          // TODO: t_proc->core_id should be changed to core_ids -> for loop for core_id

          if (fg_freq_idx[ci] > MIN_FREQ_IDX+1) {
            fg_freq_idx[ci] = fg_freq_idx[ci] - 2;
            int freq_num = FREQ_ARR[fg_freq_idx[ci]];
            fprintf(process[i]->cpu_speed_file, "%i", freq_num);
            fflush(process[i]->cpu_speed_file);
          }*/
          // FIXME: changed to support multiple cores
          for (int j = 0; j < process[i]->ci_count; j++) {
            int ci = process[i]->core_ids[j];
            //int ci = process[i]->core_id;
            if (fg_freq_idx[ci] > MIN_FREQ_IDX + 1) {
              fg_freq_idx[ci] = fg_freq_idx[ci] - 2;
              int freq_num = FREQ_ARR[fg_freq_idx[ci]];
              // FIXME: changed to support multiple cores
              fprintf(process[i]->cpu_speed_files[ci], "%i", freq_num);
              fflush(process[i]->cpu_speed_files[ci]);
            }
          }
        }
      }
    }
  }
}

void monitor_c::perf_mon(stat_c* new_s, stat_c* old_s)
{
  int32 total_l3_miss = 0;
  for (int j=0; j<process_num; j++) {
    // keep track of amount of time each core spend at each frequency
    /*int cj = process[j]->core_id;
    // TODO: t_proc->core_id should be changed to core_ids -> for loop for core_id

    // update L3 misses generated by each BG process
    int new_miss = new_s->l3_miss[cj] - old_s->l3_miss[cj];
    int new_hit = new_s->l3_hit[cj] - old_s->l3_hit[cj];
    process[j]->avg_l3_miss = (new_miss + process[j]->avg_l3_miss)/2;
    process[j]->my_l3_miss += new_miss;
    process[j]->my_l3_hit += new_hit;
    total_l3_miss += new_miss;*/
    // FIXME: Modifying codes to support multiple cores
    int new_miss[CORE_NUM];
    int new_hit[CORE_NUM];
    int sum_new_miss = 0;
    int sum_new_hit= 0;
    for (int k=0; k<process[j]->ci_count; k++) {
      int cj = process[j]->core_ids[k];
      // update L3 misses generated by each BG process
      new_miss[cj] = new_s->l3_miss[cj] - old_s->l3_miss[cj];
      new_hit[cj] = new_s->l3_hit[cj] - old_s->l3_hit[cj];
      sum_new_miss += new_miss[cj];
      sum_new_hit += new_hit[cj];
    }
    process[j]->avg_l3_miss = (sum_new_miss + process[j]->avg_l3_miss) / 2;
    process[j]->my_l3_miss += sum_new_miss;
    process[j]->my_l3_hit += sum_new_hit;
    total_l3_miss += sum_new_miss;
  }

  for (int32 i=0; i<process_num; i++) {
    //int64 ci = process[i]->core_id;
    //int64 instr = new_s->instr[ci] - old_s->instr[ci];
    // FIXME: Modify code to support multiple cores
    int64 sum_instr = 0;
    for (int j=0; j<process[i]->ci_count; j++){
      int64 ci = process[i]->core_ids[j];
      int64 instr = new_s->instr[ci] - old_s->instr[ci];
      sum_instr += instr;
    }

    //cout << "[perf_mon] "<< process[i]->fg << " "<< process[i]->exec_cyc_ptr << " " << process[i]->start_tsc << endl;
    if (!process[i]->fg) continue;

    // fg hasn't finished
    unsigned long long exec_cyc;
    sscanf(process[i]->exec_cyc_ptr, "%llu", &exec_cyc);
    if (exec_cyc != 0) continue;

    // fg has started FIXME: The below line should be commented!
    if (process[i]->start_tsc == 0) continue;

    // update bg instruction stats for this FG
    for (int32 j=0; j<process_num; j++) {
      if (!process[j]->fg) {
        /*int32 cj = process[j]->core_id;
        // TODO: t_proc->core_id should be changed to core_ids -> for loop for core_id

        process[i]->bg_instr += new_s->instr[cj] - old_s->instr[cj];*/
        // FIXME: Modify code to support multiple cores
        for (int k=0; k<process[j]->ci_count; k++){
          int32 cj = process[j]->core_ids[k];
          process[i]->bg_instr += new_s->instr[cj] - old_s->instr[cj];
        }
      }
    }

    /* get power stats */
    //SocketCounterState* skstate = new SocketCounterState;
    //*skstate = getSocketCounterState(0);
    //if (process[i]->last_skstate != NULL) {
    //  double t_energy = getConsumedJoules(*(process[i]->last_skstate), *skstate);
    //  delete process[i]->last_skstate;
    //  process[i]->energy += t_energy;
    //}
    //process[i]->last_skstate = skstate;

    // total L3 miss
    process[i]->total_l3_miss += total_l3_miss;

    for (int j=0; j<process_num; j++) {
      // keep track of amount of time each core spend at each frequency
      //int cj = process[j]->core_id;
      // FIXME: Modify code to support multiple cores
      for (int k=0; k<process[j]->ci_count; k++) {
        int cj = process[j]->core_ids[k];
        if (process[j]->fg)
          process[i]->fg_op_freq[fg_freq_idx[cj]] += new_s->tsc - old_s->tsc;
        else if (process[j]->stop)
          process[i]->bg_stop += new_s->tsc - old_s->tsc;
        else
          process[i]->bg_op_freq[bg_freq_idx] += new_s->tsc - old_s->tsc;
      }
    }
    // FIXME: all cycles (real_cyc, exp_cyc, and cyc_penalty) need to support multicore?
    int64 real_cyc = new_s->tsc - old_s->tsc;
    duration<double> elapsed_time = new_s->tp - old_s->tp;
    if (process[i]->real_cyc == 0) {
      real_cyc = new_s->tsc - process[i]->start_tsc;
      elapsed_time = new_s->tp - process[i]->exec_start_time;
    }

    real_cyc = real_cyc * process[i]->ci_count;
    // TODO: fix get_expect_value() to support multicore
    int64 exp_cyc = get_expect_value(scycle, sinstr, process[i]->total_instr + sum_instr) -
                    get_expect_value(scycle, sinstr, process[i]->total_instr);
    int64 cyc_penalty = real_cyc - exp_cyc;

    process[i]->real_cyc += real_cyc;
    process[i]->elapsed_time += elapsed_time;
    process[i]->cumulative_penalty += cyc_penalty;
    if (process[i]->cumulative_penalty < 0)
      process[i]->cumulative_penalty = 0;
    if (cyc_penalty <= 0) cyc_penalty = 0;

    int64 instr_done = 0;
    int64 exp_penalty = 1;
    /*
    cout << "EXCERPT_LEN: "<< EXCERPT_LEN << endl;
    cout << "instr: "<< instr << endl;
    cout << "instr_done: "<< instr_done << endl;
     */
    // get expected penalty and update excerpt penalty
    do {
      // curr : the pos of instr. in the excertped period ; it is also used as the index of excerpt penalty
      int64 curr = process[i]->total_instr/EXCERPT_LEN;
      // if curr exceeds EXCERPT_NUM which is the maximum number of excerpts, then set the curr to the EXCERPT_NUM - 1
      if (curr >= EXCERPT_NUM)
        curr = EXCERPT_NUM-1;
      //cout << "curr: " << curr << endl;
      // ecp_len : the amount of instr. to finish the current EXCERPT_LEN
      int64 ecp_len = EXCERPT_LEN - process[i]->total_instr % EXCERPT_LEN;
      // if current instr. progress (instr_done + ecp_len) exceeds instr. which is the execution cycle for the time segment,
      // then, ecp_len is adjusted to "instr. - instr_done" to reach to the instr. (doing exception procedure)
      if (ecp_len + instr_done > sum_instr)
        ecp_len = sum_instr - instr_done;
      /*cout << "ecp_len: "<< ecp_len << endl;*/
      // exp_penalty : the sum of excerpted penalties which are weighted by the remaining portion of EXCERPT (?)
      // FIXME: excerpt_penalty of process[i] (fg) need to be updated
      int sum_excerpt_penalty = 0;
      for (int j=0; j<process[i]->ci_count; j++){
        int idx = process[i]->core_ids[j];
        sum_excerpt_penalty += excerpt_penalty[idx][curr];
      }
      exp_penalty += sum_excerpt_penalty * ecp_len / EXCERPT_LEN;
      //exp_penalty += excerpt_penalty[ci][curr] * ecp_len / EXCERPT_LEN;

      // ecp_penalty : (the per-instr. cycle penalty) * EXCERPT_LEN (excerpted instr.) =  cycle penalty of excerpted instr.
      int64 ecp_penalty = cyc_penalty * EXCERPT_LEN / sum_instr;
      // FIXME: excerpt_penalty of process[i] (fg) need to be updated
      //excerpt_penalty[ci][curr] = excerpt_penalty[ci][curr]*0.9 + ecp_penalty*0.1; // FIXME: ci ==> process-level
      for (int j=0; j<process[i]->ci_count; j++){
        int idx = process[i]->core_ids[j];
        excerpt_penalty[idx][curr] = excerpt_penalty[idx][curr]*0.9 + ecp_penalty*0.1;
      }

      // update the total_instr. by adding ecp_len (to finish current excerpted instr. segment)
      process[i]->total_instr += ecp_len;
      instr_done += ecp_len;
      /*
      cout << "process[%d]->total_instr: "<< process[i]->total_instr <<endl;
      cout << "instr_done: "<< instr_done << ", instr: "<< instr << endl;
       */
    } while (instr_done < sum_instr);
    // repeat the calculations of excerpted penalty until all instr.s in the instr. segment are calculated.
    // do ... while loop makes "expected penalty (exp_penalty)" and "excerpted penalty (excerpt_penalty[][])"

    // scale : the ratio of cycle_penalty (from measurements) and expected penalty (from offline data)
    float scale = cyc_penalty / (float)exp_penalty;
    if (scale > 1.5) scale = 1.5;

    // next_ecp : updated total_instr / EXCERPT_LEN ; next instr. progress (next ver. of `curr`)
    int32 next_ecp = process[i]->total_instr/EXCERPT_LEN;
    if (next_ecp >= EXCERPT_NUM) next_ecp = EXCERPT_NUM-1;
    // FIXME: est_penalty --> to support multicores
    int sum_excerpt_penalty = 0;
    for (int j=0; j<process[i]->ci_count; j++){
      int idx = process[i]->core_ids[j];
      sum_excerpt_penalty += excerpt_penalty[idx][next_ecp];
    }
    // est_penalty : the sum of excerpted penalties wihch are weighted by the remaining portion of EXCERPT
    // This is SAME as "exp_penalty" (the only difference is the index of excerpt_penalty)
    float est_penalty = sum_excerpt_penalty * (EXCERPT_LEN - process[i]->total_instr % EXCERPT_LEN) / EXCERPT_LEN;
    next_ecp += 1;
    for (; next_ecp < EXCERPT_NUM; next_ecp++) {
      //est_penalty += excerpt_penalty[ci][next_ecp];
      for (int j=0; j<process[i]->ci_count; j++){
        int idx = process[i]->core_ids[j];
        est_penalty += excerpt_penalty[idx][next_ecp];
      }
    }

    // s_est_penalty : scaled expected penalty
    float s_est_penalty = scale * est_penalty;

    // eta : expected time to finish all instr.
    // eta is the sum of cycles of the all offline samples, cumulative cycle penalty, and scaled expected penalty to finish the all instr.s
    float eta = scycle[SAMPLE_LEN-1] + process[i]->cumulative_penalty + s_est_penalty;
    if (process[i]->eta_avg == 0)
      process[i]->eta_avg = eta;
    else
      process[i]->eta_avg = process[i]->eta_avg*0.8+eta*0.2;
    eta = process[i]->eta_avg;

    //if (i==0 && sample_num[ci]%20 == 0)
    //  cout<<process[i]->eta_avg<<",";
    for (int j=0; j<process[i]->ci_count; j++){
      int idx = process[i]->core_ids[j];
      sample_num[idx]++;
    }
    //sample_num[ci]++;
  }
  m_sample_num++;
  if (use_freq_scale)
    freq_scale();
  if (use_partitioning && change_partition && m_sample_num%20 == 0) {
    for (int i = 0; i < process_num; i++) {
      if (process[i]->fg) {
        // TODO: porting code segment at process.cpp:475~492 to here
        int head = process[i]->head % EXEC_RECORD_LEN;
        //process[i]->exec_record[head] = exec_cyc;
        process[i]->exec_record[head] = process[i]->eta_avg; // TODO: Test (exec_cyc -> eta_avg)
        process[i]->l3_record[head] = process[i]->my_l3_miss;
        float corr_tmp = compute_corr(process[i]->exec_record, process[i]->l3_record);
        float hit_rate_tmp = (float) process[i]->my_l3_hit / (process[i]->my_l3_hit + process[i]->my_l3_miss);
        //cout<<corr_tmp<<",";
        //cout<<hit_rate_tmp<<",";
        // if there are enough records
        if (process[i]->head + 1 >= EXEC_RECORD_LEN) {
          int partition_num = process[i]->partition_num;
          process[i]->corr[partition_num] = corr_tmp;
          process[i]->hit_rate[partition_num] = process[i]->hit_rate[partition_num] * 0.5 + hit_rate_tmp * 0.5;
          if (i == 0) // assume process 0 will always bg FG
            mngr->check_partition();
        }
        process[i]->head++;
      }
    }
  }
}

uint64 monitor_c::get_expect_value(const uint64* rarray, const uint64* sarray, uint64 data)
{
  if (data > sinstr[SAMPLE_LEN-1])    // if the total_instr. of process (data) exceeds sinstr[SAMPLE_LEN-1]
    return rarray[SAMPLE_LEN-1];      // then return max value (?)
  if (data < sinstr[0])               // if the total_instr. of process are less than sinstr[0]
    return rarray[0]*data/sinstr[0];  // return the cycles which are proportional to instr.s

  for (int i=1; i<SAMPLE_LEN; i++)
    if (data < sinstr[i])
      return rarray[i-1] + (rarray[i]-rarray[i-1])
        *(data-sinstr[i-1]) / (sinstr[i]-sinstr[i-1]);

  assert(0);
}

void monitor_c::stat_snapshot()
{
  uint64 start_cyc;
  m_MSR_handle[15]->read(16, &start_cyc);

  // keep pulling the start tsc of each process
  for (int32 i=0; i<process_num; i++)
    if (process[i]->fg)
      m_MSR_handle[i]->read(16, &process[i]->start_tsc);
      //sscanf(process[i]->start_tsc_ptr, "%llu", &process[i]->start_tsc);

  // get new stat snapshot
  stat_c* new_stat = new stat_c;
  get_stat(new_stat);
  //cout << "[after get_stat] last_stat: " << last_stat << ", new_stat: "<< new_stat << endl;
  if (last_stat != NULL)
    perf_mon(new_stat, last_stat);

#ifdef PRINT_SAMPLES
  m_timer_stat.push_back(new_stat);
#else
  if (last_stat != NULL)
    delete last_stat;
#endif
  last_stat = new_stat;
  //cout << "[after last_stat update]last_stat: " << last_stat << ", new_stat: "<< new_stat << endl;

  // get overhead number
  uint64 end_cyc;
  m_MSR_handle[15]->read(16, &end_cyc);
  uint64 tmp_overhead = end_cyc - start_cyc;
  for (int i=0; i<process_num; i++)
    process[i]->total_overhead += tmp_overhead;
}

void monitor_c::cleanup()
{
#ifdef PRINT_SAMPLES
  m_timer_ofile_cycle.close();
  m_timer_ofile_instr.close();
  //m_timer_ofile.close();
#endif
  m_PCM_handle->cleanup();
}

void monitor_c::stat_end(int proc_i)
{}

#ifdef PRINT_SAMPLES
/*
void monitor_c::write_stat(ofstream& fs, stat_c& s, stat_c& e)
{
  ofstream *f = &fs;
  *f << e.tsc - s.tsc << ",";
  *f << e.instr[0] - s.instr[0] << ",";
}
*/
void monitor_c::write_stat(ofstream& fs_cycle, ofstream& fs_instr, stat_c& s, stat_c& e, stat_c& cum)
{
  ofstream* f_cycle = &fs_cycle;
  ofstream* f_instr = &fs_instr;
  //*(f_cycle) << e.tsc - s.tsc << ",";
  //*(f_instr) << e.instr[0] - s.instr[0] << ",";
  cum.tsc += e.tsc - s.tsc;
  cum.instr[0] += e.instr[0] - s.instr[0];  // 0 means cpu_id 0 which is typically
  //*(f_cycle) << cum.tsc << ",";
  //*(f_instr) << cum.instr[0] << ",";
  *(f_cycle) << cum.tsc << ",";
  *(f_instr) << cum.instr[0] << ",";
}

void monitor_c::write_num_samples(ofstream& fs_cycle, ofstream& fs_instr, int count)
{
  ofstream* f_cycle = &fs_cycle;
  ofstream* f_instr = &fs_instr;
  *(f_cycle) << endl << count << endl;
  *(f_instr) << endl << count << endl;
  //int num_samples = m_timer_stat.size();
  //*(f_cycle) << endl << num_samples << endl;
  //*(f_instr) << endl << num_samples << endl;
}

void monitor_c::write_timer_stat()
{
  int count = 0;
  stat_c* cumulative_stat = new stat_c;           //added to make scycle and sinstr, not cycle and instr. info.
  list<stat_c*>::iterator i, j;
  j = m_timer_stat.end();
  i = m_timer_stat.begin();
  //cout<<(*i)->tsc<<",";
  for (i=m_timer_stat.begin(); i!=m_timer_stat.end(); i++) {
    if (j == m_timer_stat.end()) {
      j = i; continue;
    }
    //cout << (*i)->tsc - (*j)->tsc << ",";
    //cout << (*i)->instr[0] - (*j)->instr[0] << ",";
    //write_stat(m_timer_ofile_cycle, m_timer_ofile_instr, (stat_c&)(*i), (stat_c&)*j);
    write_stat(m_timer_ofile_cycle, m_timer_ofile_instr, *(*j), *(*i), *(cumulative_stat));
    count++;
    delete *j;
    j = m_timer_stat.erase(j);
  }
  write_num_samples(m_timer_ofile_cycle, m_timer_ofile_instr, count);
}
#endif

